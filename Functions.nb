(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    367469,       8856]
NotebookOptionsPosition[    364850,       8803]
NotebookOutlinePosition[    365315,       8821]
CellTagsIndexPosition[    365272,       8818]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions", "Section",
 CellChangeTimes->{{3.84888332921577*^9, 
  3.8488833299720287`*^9}},ExpressionUUID->"6affce9e-8bf5-478a-b701-\
d77b55bdf71a"],

Cell["\<\
This notebook contains the main functions that are used in AlgoLogs.nb\
\>", "Text",
 CellChangeTimes->{{3.8488833332719088`*^9, 3.848883344443927*^9}, {
  3.84888547384182*^9, 
  3.848885474051332*^9}},ExpressionUUID->"c3726963-2056-4a6f-9063-\
f1eb650d98cd"],

Cell[CellGroupData[{

Cell["Indices tools", "Subsection",
 CellChangeTimes->{{3.696836633781526*^9, 3.696836648566531*^9}, {
  3.696836690460126*^9, 
  3.696836701602906*^9}},ExpressionUUID->"5e3bacde-92c7-4ad3-b164-\
ab333af22125"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SDI", "=", "ScreenDollarIndices"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CI", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}], ",", 
      RowBox[{"-", "c"}], ",", 
      RowBox[{"-", "d"}], ",", 
      RowBox[{"-", "e"}], ",", 
      RowBox[{"-", "f"}], ",", 
      RowBox[{"-", "g"}], ",", 
      RowBox[{"-", "h"}], ",", 
      RowBox[{"-", "h1"}], ",", 
      RowBox[{"-", "h2"}], ",", 
      RowBox[{"-", "h3"}], ",", 
      RowBox[{"-", "h4"}], ",", 
      RowBox[{"-", "h5"}], ",", 
      RowBox[{"-", "h6"}]}], "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Canonical", " ", "indices"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpinorIndices", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", 
     "\[Lambda]", ",", "\[Rho]", ",", "\[Sigma]", ",", "\[Sigma]1", ",", 
     "\[Sigma]2", ",", "\[Sigma]3", ",", "\[Sigma]4", ",", "\[Sigma]5", ",", 
     "\[Sigma]6", ",", "\[Sigma]7", ",", "\[Sigma]8", ",", "\[Sigma]9"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpinorIndexList", "=", 
   RowBox[{"IndexList", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"SpinorIndexList", ",", 
        RowBox[{"SpinorIndices", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"SpinorIndexList", ",", 
        RowBox[{"-", 
         RowBox[{"SpinorIndices", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "SpinorIndices", "]"}]}], "}"}]}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerRaiseAll", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indices", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"ListIndices", "[", 
         RowBox[{"in", ",", "True", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", "in", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"-", 
              RowBox[{"indices", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], 
         "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerRaise", "[", 
     RowBox[{"in_", ",", "indices_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", "in", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"-", 
              RowBox[{"indices", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], 
         "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Raise", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indices", ",", "downInd"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"ListIndices", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"downInd", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"DownIndexQ", "[", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"downInd", ",", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"LowerRaise", "[", 
         RowBox[{"in", ",", "downInd"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Lower", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indices", ",", "upInd"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"ListIndices", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"upInd", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"UpIndexQ", "[", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"upInd", ",", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"LowerRaise", "[", 
         RowBox[{"in", ",", "upInd"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerM", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Res", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
          RowBox[{"Lower", "[", 
           RowBox[{"in", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ChangeFreeIndicesVB", "[", 
     RowBox[{"in_", ",", "newfrees_", ",", 
      RowBox[{"nospinor_", ":", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indices", ",", "Res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"ListIndices", "[", 
         RowBox[{"in", ",", "nospinor"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{"in", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
             RowBox[{"newfrees", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FormatEval", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{"SeparateMetric", "[", "gmn", "]"}], "[", "in", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "we", " ", "need", " ", "the", " ", "covariant", " ", "derivative", 
         " ", "to", " ", "be", " ", "all", " ", "up"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"LowerRaiseAll", "[", "Res", "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListSpinorIndices", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "indices", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"FindFreeIndices", "[", 
         RowBox[{"Evaluate", "[", "in", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{"indices", ",", "SpinorIndexList"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "indices", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"indices", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "AnyIndices"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "indices", "]"}], "\[NotEqual]", "2"}], ",", 
         
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Length", "[", "indices", "]"}], ",", 
           "\"\< spinor indices instead of expected 2\>\""}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DownIndexQ", "[", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
          RowBox[{"UpIndexQ", "[", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"indices", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"UpIndexQ", "[", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
          RowBox[{"DownIndexQ", "[", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"indices", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"indices", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<Bad structure for spinor indices\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListIndices", "[", 
     RowBox[{"in_", ",", 
      RowBox[{"nospinor_", ":", "True"}], ",", 
      RowBox[{"nonfree_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indices", ",", "nospinorind"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"If", "[", 
         RowBox[{"nonfree", ",", 
          RowBox[{"FindIndices", "[", 
           RowBox[{"Evaluate", "[", "in", "]"}], "]"}], ",", 
          RowBox[{"FindFreeIndices", "[", 
           RowBox[{"Evaluate", "[", "in", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "indices", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"indices", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "AnyIndices"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"nospinor", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nospinorind", "=", 
           RowBox[{"IndexList", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{"SpinorIndices", ",", 
                  RowBox[{"-", "SpinorIndices"}]}], "]"}], ",", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"nospinorind", ",", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "nospinorind", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "indices", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Spin", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"ListIndices", "[", "in", "]"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{"in_", ",", "trans_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"indices", ",", "new"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", "=", 
       RowBox[{"ListIndices", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"new", "=", 
       RowBox[{"Permute", "[", 
        RowBox[{"indices", ",", 
         RowBox[{"InversePermutation", "[", "trans", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"ReplaceIndex", "[", 
        RowBox[{"in", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"indices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
            RowBox[{"new", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], 
        "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6964082855343227`*^9, 3.696408289305133*^9}, {
   3.696408486440646*^9, 3.696408496051062*^9}, {3.696408645060515*^9, 
   3.696408663557135*^9}, {3.696410311392951*^9, 3.696410324850418*^9}, {
   3.696415356596669*^9, 3.696415373044615*^9}, {3.696416297585588*^9, 
   3.69641630917212*^9}, {3.696416673905641*^9, 3.6964166902417793`*^9}, {
   3.6964167250110407`*^9, 3.696416750049761*^9}, {3.696417709979868*^9, 
   3.696417941206827*^9}, {3.696418025598662*^9, 3.696418059797942*^9}, {
   3.696418236039549*^9, 3.6964183671147842`*^9}, {3.696418409845564*^9, 
   3.696418448370912*^9}, {3.6964184796396837`*^9, 3.696418516831854*^9}, {
   3.696418674250139*^9, 3.696418707527837*^9}, {3.696418754574883*^9, 
   3.696418860741495*^9}, {3.696418898163432*^9, 3.6964189144691973`*^9}, {
   3.696418952331728*^9, 3.696418990800852*^9}, {3.6964191167356443`*^9, 
   3.6964191650622587`*^9}, {3.696419250547624*^9, 3.6964193701301813`*^9}, {
   3.6964194195877657`*^9, 3.696419427398684*^9}, {3.6964195304376507`*^9, 
   3.696419542330607*^9}, {3.696419866978849*^9, 3.696419903248851*^9}, {
   3.696420044005559*^9, 3.696420044262363*^9}, {3.6964200855887623`*^9, 
   3.696420089795434*^9}, {3.696420252866478*^9, 3.696420255720439*^9}, {
   3.696420486322806*^9, 3.696420497968133*^9}, {3.696420739987516*^9, 
   3.6964207601558857`*^9}, {3.696420822850482*^9, 3.6964209409413347`*^9}, {
   3.6964211079612627`*^9, 3.6964211713989067`*^9}, {3.696421279565621*^9, 
   3.696421282990244*^9}, {3.69642131559839*^9, 3.696421351913385*^9}, {
   3.696421400244089*^9, 3.696421450602768*^9}, {3.696421481190241*^9, 
   3.696421637375578*^9}, {3.696421672129694*^9, 3.696421674440941*^9}, {
   3.696421708675269*^9, 3.696421747201167*^9}, {3.696421791736018*^9, 
   3.6964218599951687`*^9}, {3.6964218961736403`*^9, 3.696421896324236*^9}, {
   3.696421956076603*^9, 3.696421967880481*^9}, {3.6964220075870657`*^9, 
   3.696422027292239*^9}, 3.6964223814454403`*^9, 3.696422538093316*^9, {
   3.696422583914379*^9, 3.696422601023201*^9}, {3.696423555213779*^9, 
   3.69642355590522*^9}, {3.6964236748902683`*^9, 3.6964236859915533`*^9}, {
   3.696424394152068*^9, 3.696424494832549*^9}, {3.696424564849329*^9, 
   3.696424564914461*^9}, {3.6964246639930477`*^9, 3.6964246644941063`*^9}, {
   3.696424746030456*^9, 3.6964247483373823`*^9}, {3.69642479051689*^9, 
   3.6964248322058372`*^9}, {3.6964250298663282`*^9, 3.696425187262019*^9}, {
   3.6964252984878817`*^9, 3.696425312062241*^9}, {3.696425398116468*^9, 
   3.696425499254409*^9}, {3.696425584349407*^9, 3.696425857149706*^9}, {
   3.696425931118677*^9, 3.6964259673063107`*^9}, {3.696428537641552*^9, 
   3.696428563264927*^9}, {3.6964291513778353`*^9, 3.696429154455818*^9}, {
   3.696429758003605*^9, 3.6964297945499563`*^9}, {3.696443894608074*^9, 
   3.696443922245151*^9}, {3.696445597006762*^9, 3.696445620100058*^9}, 
   3.696445657340682*^9, {3.696446120617919*^9, 3.696446123835693*^9}, {
   3.696446156912427*^9, 3.696446241497944*^9}, {3.696446275760997*^9, 
   3.696446275810067*^9}, {3.696446350991996*^9, 3.6964463887049723`*^9}, {
   3.696446428071211*^9, 3.696446526405425*^9}, {3.69644656734226*^9, 
   3.696446567840173*^9}, {3.696447473418159*^9, 3.696447474528347*^9}, {
   3.69644752642813*^9, 3.696447546849863*^9}, 3.696447582954811*^9, {
   3.69644771983847*^9, 3.696447721363319*^9}, 3.696447754427319*^9, 
   3.696447856516947*^9, {3.696448110587488*^9, 3.69644811877522*^9}, {
   3.696448515338537*^9, 3.696448544523134*^9}, {3.696479321955947*^9, 
   3.696479358291106*^9}, {3.696479391280116*^9, 3.6964794055308867`*^9}, {
   3.696479873966673*^9, 3.696479903685637*^9}, {3.6964799399274483`*^9, 
   3.6964799424123287`*^9}, {3.696479992020426*^9, 3.6964803122011213`*^9}, {
   3.696480352586227*^9, 3.6964803854402943`*^9}, {3.696480417217513*^9, 
   3.696480423556678*^9}, {3.6964805369620123`*^9, 3.6964805630173807`*^9}, {
   3.696480596024949*^9, 3.6964805965091543`*^9}, {3.6964806886421843`*^9, 
   3.696480692638916*^9}, {3.696480750730146*^9, 3.6964807870672693`*^9}, {
   3.696480982079855*^9, 3.6964810027913322`*^9}, 3.6964822048887453`*^9, 
   3.696483769286983*^9, {3.696483818475378*^9, 3.696483820599094*^9}, 
   3.696483855773486*^9, {3.696484021076118*^9, 3.6964840263304653`*^9}, 
   3.69648427695968*^9, {3.6964845420017233`*^9, 3.696484545247149*^9}, {
   3.696484697446254*^9, 3.696484739772698*^9}, {3.696485287921837*^9, 
   3.696485290636508*^9}, {3.69648535312012*^9, 3.696485391197907*^9}, 
   3.696485715373856*^9, {3.696485749889955*^9, 3.696485809381765*^9}, {
   3.696485855608314*^9, 3.696485858971583*^9}, {3.6964869724191437`*^9, 
   3.696487025847309*^9}, {3.6964874713680553`*^9, 3.696487474314745*^9}, {
   3.696491431403616*^9, 3.696491444684689*^9}, {3.6964920250750637`*^9, 
   3.696492128824011*^9}, {3.696492198958103*^9, 3.69649221235575*^9}, {
   3.696492284327071*^9, 3.6964923005163717`*^9}, {3.696493003408743*^9, 
   3.696493067222681*^9}, {3.696493099677853*^9, 3.696493150092402*^9}, {
   3.6964932293488092`*^9, 3.696493382884995*^9}, {3.6964936166171007`*^9, 
   3.696493652851994*^9}, {3.696493914782753*^9, 3.696494011029475*^9}, {
   3.696494099458425*^9, 3.69649411243097*^9}, {3.696494146269987*^9, 
   3.69649434231607*^9}, {3.69649441724675*^9, 3.696494506855879*^9}, {
   3.696494553545443*^9, 3.696494553686365*^9}, {3.696495275342057*^9, 
   3.69649533562993*^9}, {3.696500373237403*^9, 3.696500390493107*^9}, {
   3.696500528824725*^9, 3.696500603556925*^9}, {3.696500636645034*^9, 
   3.696500895422721*^9}, {3.696500937509089*^9, 3.69650106576088*^9}, {
   3.696501342609457*^9, 3.696501457805807*^9}, {3.6965016104289913`*^9, 
   3.696501682549941*^9}, {3.696501880635901*^9, 3.696501892443563*^9}, {
   3.696501955275936*^9, 3.6965019748566217`*^9}, {3.696502361064151*^9, 
   3.6965023877467422`*^9}, {3.69650241947747*^9, 3.696502450565196*^9}, {
   3.6965025332004642`*^9, 3.696502560599349*^9}, {3.696502617062194*^9, 
   3.696502661219015*^9}, {3.696502696044241*^9, 3.69650271108393*^9}, {
   3.696507888372323*^9, 3.696507904605297*^9}, {3.696509926729197*^9, 
   3.6965099888933764`*^9}, {3.696510026598463*^9, 3.696510115956575*^9}, {
   3.69651253319881*^9, 3.696512611095808*^9}, 3.6965172646349373`*^9, {
   3.6965200701451*^9, 3.696520070400082*^9}, {3.696520137194696*^9, 
   3.6965201386768084`*^9}, {3.696520234063693*^9, 3.6965202341948633`*^9}, {
   3.696524853804335*^9, 3.696524885042535*^9}, {3.696524927668399*^9, 
   3.69652495667887*^9}, {3.696538930078396*^9, 3.696538931365758*^9}, {
   3.6965656200155907`*^9, 3.69656562493222*^9}, {3.696566913918676*^9, 
   3.696566920484667*^9}, {3.696566968515994*^9, 3.696566968733061*^9}, {
   3.696567147993762*^9, 3.69656714923387*^9}, {3.696569909914576*^9, 
   3.696570017334928*^9}, {3.69657018609091*^9, 3.6965702437704153`*^9}, {
   3.6965703987314672`*^9, 3.696570398854089*^9}, {3.696571601563653*^9, 
   3.6965716380264893`*^9}, {3.6965749394524384`*^9, 3.69657494120262*^9}, {
   3.696575013764188*^9, 3.696575028227265*^9}, {3.696575163528603*^9, 
   3.6965752023565063`*^9}, {3.696575630618142*^9, 3.6965757296546173`*^9}, {
   3.696575770121348*^9, 3.696575771485355*^9}, {3.6965758107371473`*^9, 
   3.6965759540182123`*^9}, {3.696576074549245*^9, 3.696576325887918*^9}, {
   3.696576370248109*^9, 3.696576382069615*^9}, {3.696576456020361*^9, 
   3.6965764820353737`*^9}, {3.696576618731735*^9, 3.696576655157585*^9}, {
   3.696576708582181*^9, 3.696576801939311*^9}, {3.696576842877676*^9, 
   3.696576843042676*^9}, {3.696576882959734*^9, 3.696576884116935*^9}, {
   3.696576941223229*^9, 3.69657699248272*^9}, {3.696577073510092*^9, 
   3.696577075988352*^9}, {3.69657719103251*^9, 3.69657722270673*^9}, 
   3.6965772552548637`*^9, {3.696577294580491*^9, 3.696577401169426*^9}, {
   3.6965775271754723`*^9, 3.6965776104025803`*^9}, {3.696577643836236*^9, 
   3.6965776493310537`*^9}, 3.696578358328197*^9, 3.6965783905729933`*^9, {
   3.696579334510848*^9, 3.6965794582874002`*^9}, {3.6965834181096497`*^9, 
   3.696583442874401*^9}, {3.696583562544341*^9, 3.696583603958074*^9}, {
   3.696583658839945*^9, 3.69658374184999*^9}, {3.696583827840982*^9, 
   3.6965838538868437`*^9}, {3.696584002477539*^9, 3.696584057961071*^9}, {
   3.696584268904375*^9, 3.696584269057555*^9}, {3.6965861883783693`*^9, 
   3.69658619033491*^9}, {3.69658934133847*^9, 3.696589365222664*^9}, {
   3.6966002570887613`*^9, 3.696600322956833*^9}, {3.6966003706219997`*^9, 
   3.696600449414218*^9}, {3.696668990746211*^9, 3.696669039892902*^9}, {
   3.696675532066362*^9, 3.6966755329281797`*^9}, {3.696677272646955*^9, 
   3.696677275556685*^9}, {3.696678153688664*^9, 3.696678159350281*^9}, {
   3.696681330179969*^9, 3.696681347457328*^9}, {3.696681481176153*^9, 
   3.696681487709646*^9}, {3.6966815564839497`*^9, 3.6966815729000072`*^9}, {
   3.696681809413684*^9, 3.696681812972125*^9}, {3.696681915725222*^9, 
   3.6966819160753527`*^9}, {3.696682483857909*^9, 3.696682537185131*^9}, {
   3.6966888597060337`*^9, 3.696688865009225*^9}, {3.6966890861983337`*^9, 
   3.696689117035389*^9}, {3.696689163582181*^9, 3.69668919156787*^9}, {
   3.696689321360271*^9, 3.696689321574931*^9}, {3.696689729271236*^9, 
   3.69668973248002*^9}, {3.696689811395811*^9, 3.6966898314567823`*^9}, 
   3.696689870205183*^9, 3.696690179985341*^9, {3.69669056304562*^9, 
   3.6966905704957542`*^9}, {3.696690621690063*^9, 3.696690621806326*^9}, {
   3.696690729485796*^9, 3.696690729569694*^9}, {3.696691388182226*^9, 
   3.696691389273014*^9}, 3.696692041915167*^9, {3.696692162011791*^9, 
   3.696692220524839*^9}, {3.6966923176102533`*^9, 3.696692340374175*^9}, {
   3.696693031128627*^9, 3.696693058327091*^9}, {3.6966944502400093`*^9, 
   3.696694494369336*^9}, {3.696694526041314*^9, 3.696694566452888*^9}, 
   3.6966969344355583`*^9, {3.6966973814673967`*^9, 3.696697405531397*^9}, 
   3.696697655907463*^9, 3.696700791792932*^9, {3.6967009682686443`*^9, 
   3.696700983297963*^9}, {3.6967011537096148`*^9, 3.6967011563236437`*^9}, {
   3.696701311833363*^9, 3.69670131769232*^9}, {3.696702646052765*^9, 
   3.6967026855248413`*^9}, {3.696703016875908*^9, 3.696703028049781*^9}, {
   3.696703083444713*^9, 3.6967031175340347`*^9}, {3.6967031523428793`*^9, 
   3.6967031642624397`*^9}, {3.696703232086904*^9, 3.6967032383742743`*^9}, {
   3.696703335649461*^9, 3.696703337774864*^9}, {3.696703622456602*^9, 
   3.696703646716213*^9}, 3.696703723882106*^9, {3.696703783206128*^9, 
   3.696703817047845*^9}, {3.696703861610244*^9, 3.696703877847663*^9}, {
   3.6967040357037573`*^9, 3.6967040384563103`*^9}, {3.6967040992347317`*^9, 
   3.696704155753479*^9}, {3.696705199085271*^9, 3.696705205475296*^9}, {
   3.6967636143563967`*^9, 3.696763616241074*^9}, 3.696786851931406*^9, {
   3.696787452889236*^9, 3.6967876425147467`*^9}, {3.696787687907102*^9, 
   3.6967877450006723`*^9}, {3.6967878037437687`*^9, 
   3.6967878313526382`*^9}, {3.6968181479023314`*^9, 
   3.6968181481661386`*^9}, {3.6968182199853287`*^9, 3.69681823292738*^9}, {
   3.696818304230886*^9, 3.6968183048221197`*^9}, {3.696818444554435*^9, 
   3.696818457526001*^9}, {3.696818591564128*^9, 3.69681862774255*^9}, {
   3.696819065262835*^9, 3.696819118387006*^9}, {3.696819372893252*^9, 
   3.6968194091216917`*^9}, {3.696823666373165*^9, 3.696823684338459*^9}, {
   3.696823725580896*^9, 3.696823811794055*^9}, {3.6968293217580547`*^9, 
   3.696829429152009*^9}, {3.696829473769723*^9, 3.696829527416362*^9}, {
   3.696829610983955*^9, 3.696829613590156*^9}, {3.69682975412185*^9, 
   3.6968298335511017`*^9}, {3.696829865556549*^9, 3.696829918766677*^9}, {
   3.696829954758465*^9, 3.696829989673526*^9}, {3.69683662580954*^9, 
   3.696836715567054*^9}, {3.6968509082834883`*^9, 3.696850969976398*^9}, {
   3.696866262256114*^9, 3.696866267735441*^9}, {3.696866329089923*^9, 
   3.6968663306037197`*^9}, {3.696866416684963*^9, 3.696866481417495*^9}, {
   3.696866589720539*^9, 3.6968665918552313`*^9}, {3.696866942113863*^9, 
   3.696866942268723*^9}, {3.6978876195362*^9, 3.6978876414854603`*^9}, {
   3.703304761409367*^9, 3.703304761713567*^9}, {3.7033048901554832`*^9, 
   3.703304890766576*^9}, {3.703321608315362*^9, 3.7033216228672256`*^9}, {
   3.734180790555977*^9, 3.734180804014553*^9}, {3.734180864309639*^9, 
   3.734180866250964*^9}, {3.734182468441578*^9, 3.73418246996843*^9}, {
   3.7341825453570557`*^9, 3.734182547124091*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c83d65ac-081c-4d9f-ab73-0c627fc3440e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor contraction", "Subsection",
 CellChangeTimes->{{3.6968367238901653`*^9, 3.6968367287314873`*^9}, {
  3.696836807721287*^9, 
  3.6968368124718647`*^9}},ExpressionUUID->"e283b3d3-625f-4bc3-8e24-\
e9b83d2e6b40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"multiDot", "[", 
     RowBox[{"in1_", ",", "in2_", ",", "list_", ",", 
      RowBox[{"nospinor_", ":", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "indices1", ",", "indices2", ",", "n1", ",", "n2", ",", "nfinal", ",", 
        "dummies1", ",", "dummies2", ",", "int1", ",", "int2", ",", 
        "spinind1", ",", "spinind2", ",", "Res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"in1", "\[Equal]", "0"}], "||", 
          RowBox[{"in2", "\[Equal]", "0"}]}], ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices1", "=", 
        RowBox[{"ListIndices", "[", "in1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices2", "=", 
        RowBox[{"ListIndices", "[", "in2", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "indices1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{"Length", "[", "indices2", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nfinal", "=", 
        RowBox[{"n1", "+", "n2", "-", 
         RowBox[{"2", 
          RowBox[{"Length", "[", "list", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dummies1", "=", 
        RowBox[{"{", 
         RowBox[{
         "w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5", ",", "w6", ",", 
          "w7", ",", "w8", ",", "w9"}], "}"}]}], ";", 
       RowBox[{"dummies2", "=", 
        RowBox[{"{", 
         RowBox[{
         "y1", ",", "y2", ",", "y3", ",", "y4", ",", "y5", ",", "y6", ",", 
          "y7", ",", "y8", ",", "y9"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dummies1", "=", 
        RowBox[{"dummies1", "[", 
         RowBox[{"[", 
          RowBox[{";;", "n1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dummies2", "=", 
        RowBox[{"dummies2", "[", 
         RowBox[{"[", 
          RowBox[{";;", "n2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"int1", "=", 
        RowBox[{"ReplaceDummies", "[", 
         RowBox[{"ReplaceIndex", "[", 
          RowBox[{"in1", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indices1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
              RowBox[{"dummies1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n1"}], "}"}]}], "]"}]}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"int2", "=", 
        RowBox[{"ReplaceDummies", "[", 
         RowBox[{"ReplaceIndex", "[", 
          RowBox[{"in2", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indices2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
              RowBox[{"dummies2", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n2"}], "}"}]}], "]"}]}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"spinind1", "=", 
        RowBox[{"ListSpinorIndices", "[", "in1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"spinind2", "=", 
        RowBox[{"ListSpinorIndices", "[", "in2", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "spinind1", "]"}], "\[Equal]", "2"}], "&&", 
          
          RowBox[{
           RowBox[{"Length", "[", "spinind2", "]"}], "\[Equal]", "2"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"int1", "=", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "int1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"spinind1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"-", "\[Alpha]"}]}], ",", 
               RowBox[{
                RowBox[{"spinind1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "\[Gamma]"}]}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"int2", "=", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "int2", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"spinind2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"-", "\[Gamma]"}]}], ",", 
               RowBox[{
                RowBox[{"spinind2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "\[Beta]"}]}], 
              "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"int1", " ", "int2"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Res", "=", 
          RowBox[{"Res", " ", 
           RowBox[{"gmn", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"dummies1", "[", 
               RowBox[{"[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
             
             RowBox[{"-", 
              RowBox[{"dummies2", "[", 
               RowBox[{"[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}]}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"ReplaceDummies", "[", 
         RowBox[{"ContractMetric", "[", 
          RowBox[{"Evaluate", "[", "Res", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"ChangeFreeIndicesVB", "[", 
         RowBox[{"Res", ",", 
          RowBox[{"CI", "[", 
           RowBox[{"[", 
            RowBox[{";;", "nfinal"}], "]"}], "]"}], ",", "nospinor"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"Res", "//", "Simp"}], "//", "SDI"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"norm", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"FindFreeIndices", "[", "in", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"multiDot", "[", 
         RowBox[{"in", ",", "in", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "i"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "]"}], "]"}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covD", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Spin", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"CD", "[", 
          RowBox[{"CI", "[", 
           RowBox[{"[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}], "]"}], "[", 
         RowBox[{"ChangeFreeIndicesVB", "[", 
          RowBox[{
           RowBox[{"ReplaceDummies", "[", 
            RowBox[{"Evaluate", "[", "in", "]"}], "]"}], ",", "CI"}], "]"}], 
         "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Contract", "[", 
     RowBox[{"in_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indices", ",", "Res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"ListIndices", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "in"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Res", " ", "=", " ", 
          RowBox[{"Res", " ", 
           RowBox[{"gmn", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"indices", "[", 
               RowBox[{"[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
             
             RowBox[{"-", 
              RowBox[{"indices", "[", 
               RowBox[{"[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}]}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"ReplaceDummies", "[", 
         RowBox[{"ContractMetric", "[", 
          RowBox[{"Evaluate", "[", "Res", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"ChangeFreeIndicesVB", "[", 
         RowBox[{"Res", ",", 
          RowBox[{"CI", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"Spin", "[", "Res", "]"}]}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"Res", "//", "Simp"}], "//", "SDI"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tp", "[", 
    RowBox[{"in1_", ",", "in2_", ",", 
     RowBox[{"nospinor_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"in1", ",", "in2", ",", 
         RowBox[{"{", "}"}], ",", "nospinor"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696836745691227*^9, 3.6968367673459797`*^9}, {
   3.698406306317192*^9, 3.6984064269634523`*^9}, {3.698406465983652*^9, 
   3.6984065282156153`*^9}, {3.698406591558432*^9, 3.698406598844969*^9}, {
   3.6984066361647263`*^9, 3.698406647355535*^9}, {3.6984122675275087`*^9, 
   3.6984122735811367`*^9}, {3.6984123456249323`*^9, 3.698412353232521*^9}, {
   3.698413869269525*^9, 3.698413874466269*^9}, {3.6984853787243557`*^9, 
   3.698485379537404*^9}, {3.7033047473423347`*^9, 3.7033047495305443`*^9}, {
   3.830811462708679*^9, 3.830811479839994*^9}, {3.830811517686755*^9, 
   3.830811538176264*^9}, {3.8308115848045607`*^9, 3.830811585196548*^9}, {
   3.830812006064808*^9, 3.830812006310781*^9}, {3.83081222929107*^9, 
   3.830812242756074*^9}, 3.830812302449519*^9, {3.8308123804722023`*^9, 
   3.830812382856987*^9}, {3.830812503909388*^9, 3.830812522087309*^9}, {
   3.8308125941236486`*^9, 3.830812598473628*^9}, {3.83081262915779*^9, 
   3.830812681996973*^9}, {3.83081286947713*^9, 3.830812925832786*^9}, {
   3.830812962424225*^9, 3.830812977319372*^9}, {3.830813159146084*^9, 
   3.83081318774162*^9}, {3.8308133865326014`*^9, 3.8308135474111834`*^9}, {
   3.830813599084339*^9, 3.8308136049880867`*^9}, {3.8308136575936747`*^9, 
   3.8308136578622713`*^9}, {3.830813829280136*^9, 3.830813829570875*^9}, {
   3.830813918677701*^9, 3.830813945298442*^9}, 3.830814655695302*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"1e2d426b-519f-42d7-bed3-0202f3b8edf4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor manipulation", "Subsection",
 CellChangeTimes->{{3.696927019836794*^9, 
  3.696927025317721*^9}},ExpressionUUID->"5ee06429-47f7-4592-abab-\
a4d3cb6ea58b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FourCanonical", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "prec", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"in", "/.", "CompareRules"}], "//", "fSimp"}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prec", "=", "0"}], ";", 
       RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"prec", "-", "Res"}], "//", "Simp"}], ")"}]}], "]"}], 
           ">", "0"}], "&&", 
          RowBox[{"i", "<", "20"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prec", "=", "Res"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Res", "/.", "EinsteinRule"}], "/.", 
                 "OnShellRules"}], "/.", "BianchiRules"}], "/.", "DDFFRule"}],
               "/.", "SimpRules"}], "//", "Simp"}], "//", "Expand"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FourDualCanon", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "prec", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"in", "/.", "CompareRules"}], "//", "fSimp"}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prec", "=", "0"}], ";", 
       RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"prec", "-", "Res"}], "//", "Simp"}], ")"}]}], "]"}], 
           ">", "0"}], "&&", 
          RowBox[{"i", "<", "10"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prec", "=", "Res"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Res", "/.", "EliminateDualRules"}], "/.", 
             "SchoutenRules"}], "//", "FourCanonical"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Res", "/.", "FcDualRule"}], "/.", "SchoutenRules"}], "//",
           "Simp"}], "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"Res", "//", "FourCanonical"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FCoefficient", "[", 
     RowBox[{"in_", ",", "elem_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"int", ",", "elemint"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"elemint", "=", 
        RowBox[{
         RowBox[{"ReplaceDummies", "[", 
          RowBox[{"Evaluate", "[", "elem", "]"}], "]"}], "//", "SDI"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"int", "=", 
        RowBox[{
         RowBox[{"ReplaceDummies", "[", 
          RowBox[{"Evaluate", "[", "in", "]"}], "]"}], "//", "SDI"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{"int", ",", "elemint"}], "]"}], "+", "\[Pi]"}], "]"}], 
          "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"int", ",", 
            RowBox[{"elemint", "//", "LowerRaiseAll"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"int", ",", "elemint"}], "]"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FDecompose", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "terms", ",", "coeff", ",", "int", ",", "acoeff", ",", "ccoeff", ",", 
        "R2coeff", ",", "allcoeff", ",", "verif", ",", "vEuler", ",", 
        "vWeyl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"terms", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"RR", ",", "RicRic"}], "}"}], ",", "FTerms"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vEuler", " ", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "d"}]}], "]"}], 
          RowBox[{"RiemannCD", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          RowBox[{"RicciCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}]}], "]"}], 
          RowBox[{"RicciCD", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"RicciScalarCD", "[", "]"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vWeyl", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "d"}]}], "]"}], 
          RowBox[{"RiemannCD", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"RicciCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}]}], "]"}], 
          RowBox[{"RicciCD", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "3"], 
          SuperscriptBox[
           RowBox[{"RicciScalarCD", "[", "]"}], "2"]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"int", "=", 
        RowBox[{
         RowBox[{"ReplaceDummies", "[", 
          RowBox[{"Evaluate", "[", "in", "]"}], "]"}], "//", "SDI"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coeff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"FCoefficient", "[", 
           RowBox[{"int", ",", 
            RowBox[{"terms", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "terms", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"acoeff", "=", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"2", 
            RowBox[{"coeff", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"coeff", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ccoeff", "=", 
        FractionBox[
         RowBox[{
          RowBox[{"4", 
           RowBox[{"coeff", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"coeff", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "2"]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R2coeff", "=", 
        RowBox[{
         RowBox[{"coeff", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "-", "acoeff", "-", 
         FractionBox["ccoeff", "3"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allcoeff", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"acoeff", ",", "ccoeff", ",", "R2coeff"}], "}"}], ",", 
           RowBox[{"coeff", "[", 
            RowBox[{"[", 
             RowBox[{"4", ";;"}], "]"}], "]"}]}], "]"}], "//", "Simplify"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"verif", "=", 
        RowBox[{"allcoeff", ".", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vEuler", ",", "vWeyl"}], "}"}], ",", "FTerms"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Remains: \>\"", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"in", "-", "verif"}], "//", "Simp"}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Value: \>\"", ",", " ", 
         RowBox[{"allcoeff", ".", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<Euler\>\"", ",", 
              "\"\<\!\(\*SuperscriptBox[\(Weyl\), \(2\)]\)\>\""}], "}"}], ",",
             "FTerms"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "allcoeff", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotCanonical", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "prec", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "isModuliOn"}], ",", 
         RowBox[{"Return", "[", "\"\<No moduli\>\"", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{"in", "/.", 
          RowBox[{"swick", "\[Rule]", "1"}]}], "//", "FourDualCanon"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"prec", "=", "0"}], ";", 
       RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"2", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"prec", "-", "Res"}], "//", "Simp"}], ")"}]}], "]"}], 
           ">", "0"}], "&&", 
          RowBox[{"i", "<", "5"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prec", "=", "Res"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"isExtremal", ",", 
             RowBox[{"Res", "=", 
              RowBox[{"Res", "/.", "ExtremalRules"}]}]}], "]"}], "//", 
           "Expand"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Res", "/.", "IPPRules"}], "//", "Simp"}], "//", 
            "Expand"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Res", "/.", "DerRules"}], "/.", "FcDualRule"}], "/.", 
              "SchoutenRules"}], "//", "Simp"}], "//", "Expand"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Res", "=", 
           RowBox[{"Res", "//", "FourDualCanon"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "integrates", " ", "by", " ", "parts", " ", "term", " ", 
    "with", " ", "more", " ", "than", " ", "two", " ", "consecutive", " ", 
    "derivatives"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateByPart", "[", "in_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pattern", ",", "Res", ",", "M"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pattern", "=", 
       RowBox[{
        RowBox[{"CD", "[", 
         RowBox[{"-", "a"}], "]"}], "[", 
        RowBox[{
         RowBox[{"CD", "[", 
          RowBox[{"-", "b"}], "]"}], "[", 
         RowBox[{"y1b", "[", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Res", "=", "in"}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"IndexCoefficient", "[", 
        RowBox[{"in", ",", "pattern"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Res", "=", 
          RowBox[{"in", "/.", 
           RowBox[{"MakeRule", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], "}"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Res", "+=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"CD", "[", 
              RowBox[{"-", "a"}], "]"}], "[", "M", "]"}]}], 
           RowBox[{
            RowBox[{"CD", "[", 
             RowBox[{"-", "b"}], "]"}], "[", 
            RowBox[{"y1b", "[", "]"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696926903366642*^9, 3.696926941124394*^9}, {
   3.6969270880335627`*^9, 3.696927182143217*^9}, {3.696927232813699*^9, 
   3.696927297402878*^9}, {3.696927481532337*^9, 3.696927482482593*^9}, {
   3.696928259142394*^9, 3.696928407069167*^9}, {3.696928481509221*^9, 
   3.696928490097794*^9}, {3.6969285478929253`*^9, 3.69692855182441*^9}, {
   3.6969285865445433`*^9, 3.696928760405549*^9}, {3.696928821953658*^9, 
   3.6969289848294287`*^9}, {3.6969290177381067`*^9, 3.696929091996726*^9}, {
   3.696929126665015*^9, 3.6969291481916533`*^9}, {3.6969291931727543`*^9, 
   3.6969291970892*^9}, {3.696929288403854*^9, 3.6969292909074697`*^9}, {
   3.696929909851597*^9, 3.696929940785507*^9}, {3.6969340860641403`*^9, 
   3.696934155422777*^9}, {3.696934209301796*^9, 3.696934211364119*^9}, {
   3.696934377400887*^9, 3.696934382501912*^9}, {3.696934439328124*^9, 
   3.696934456492*^9}, {3.696934516612691*^9, 3.696934537818473*^9}, {
   3.696936036635621*^9, 3.696936039730671*^9}, {3.696967877606246*^9, 
   3.6969679488801403`*^9}, {3.69697205576945*^9, 3.696972083134577*^9}, 
   3.696972134632571*^9, {3.6970026708239927`*^9, 3.697002715830121*^9}, {
   3.697003554143824*^9, 3.69700355808403*^9}, {3.697019037866261*^9, 
   3.697019111260558*^9}, {3.697020006764462*^9, 3.697020055880312*^9}, {
   3.697032648972913*^9, 3.697032652659341*^9}, {3.697032777794393*^9, 
   3.6970327779277573`*^9}, {3.697040474739938*^9, 3.6970406699881277`*^9}, {
   3.697040772162156*^9, 3.697040782834594*^9}, {3.697040929036376*^9, 
   3.697040967292268*^9}, {3.697041128217194*^9, 3.697041152007223*^9}, {
   3.6970412549360247`*^9, 3.697041337020823*^9}, {3.697106304424322*^9, 
   3.6971063860531054`*^9}, {3.697179859615209*^9, 3.69717988435067*^9}, {
   3.697180219236849*^9, 3.69718023245468*^9}, {3.697181109692801*^9, 
   3.697181119850317*^9}, {3.6971811587392387`*^9, 3.697181167392823*^9}, {
   3.697181411876796*^9, 3.697181419905819*^9}, {3.697182734590972*^9, 
   3.697182734854219*^9}, {3.697182892485402*^9, 3.6971829145294237`*^9}, 
   3.697182968566228*^9, {3.69718302275893*^9, 3.697183050348756*^9}, {
   3.697188202464291*^9, 3.697188320041844*^9}, {3.6971884047565928`*^9, 
   3.6971884122096567`*^9}, {3.697188443279786*^9, 3.697188443409111*^9}, 
   3.697188789585243*^9, {3.697351028701057*^9, 3.69735103537002*^9}, {
   3.6973511254051867`*^9, 3.697351127250534*^9}, {3.697351376555604*^9, 
   3.697351380472537*^9}, {3.697351984138542*^9, 3.6973519848940153`*^9}, {
   3.697355697098116*^9, 3.6973557358867483`*^9}, {3.697355770007189*^9, 
   3.697355783303522*^9}, {3.697356086414323*^9, 3.697356095462652*^9}, {
   3.6973804096020823`*^9, 3.697380461592013*^9}, {3.697380982044511*^9, 
   3.6973810284479017`*^9}, 3.697381130570511*^9, {3.6973842097483873`*^9, 
   3.697384211335507*^9}, {3.6973842526012278`*^9, 3.697384253903885*^9}, {
   3.697386444423213*^9, 3.697386606210209*^9}, {3.6973867132289257`*^9, 
   3.697386713842331*^9}, {3.697390159577609*^9, 3.6973901677913017`*^9}, {
   3.697390887314077*^9, 3.69739088837871*^9}, {3.697394805301462*^9, 
   3.697394807535136*^9}, {3.6973949048292093`*^9, 3.697394916472205*^9}, {
   3.697395056718845*^9, 3.697395064537058*^9}, {3.6973951041900682`*^9, 
   3.6973951051980543`*^9}, {3.697395448966152*^9, 3.697395450802329*^9}, {
   3.697395821172544*^9, 3.6973958230410337`*^9}, {3.697396047523726*^9, 
   3.697396055376295*^9}, {3.697396168719947*^9, 3.697396170661154*^9}, {
   3.697397419236614*^9, 3.697397490311715*^9}, {3.697436241272154*^9, 
   3.697436253333591*^9}, {3.697436454647335*^9, 3.697436454975141*^9}, {
   3.69743683586792*^9, 3.697436837992504*^9}, {3.697436891297922*^9, 
   3.697436893238484*^9}, 3.6974534939830437`*^9, 3.6974549469857903`*^9, {
   3.697478257016453*^9, 3.697478273491495*^9}, {3.6977197502772923`*^9, 
   3.697719756661004*^9}, {3.697723049978208*^9, 3.6977230846349707`*^9}, {
   3.697723121732049*^9, 3.6977231530737534`*^9}, {3.698477014952821*^9, 
   3.698477016545712*^9}, {3.703306418725944*^9, 3.703306421009802*^9}, {
   3.703306475402524*^9, 3.703306477448578*^9}, {3.703306512528778*^9, 
   3.703306526047756*^9}, {3.703306562711607*^9, 3.7033065792466393`*^9}, {
   3.703306638303547*^9, 3.703306700665844*^9}, {3.703313269327118*^9, 
   3.703313281348847*^9}, {3.703313662417926*^9, 3.703313710505596*^9}, {
   3.703321631525023*^9, 3.703321635698978*^9}, {3.703321900134288*^9, 
   3.703321974424048*^9}, {3.7033582189200497`*^9, 3.703358223713676*^9}, {
   3.703358262383676*^9, 3.703358264854136*^9}, {3.703391935242752*^9, 
   3.703391936751924*^9}, {3.7033922311522417`*^9, 3.703392236302072*^9}, {
   3.716118205534335*^9, 3.7161182059894342`*^9}, {3.7249266510145617`*^9, 
   3.724926651172737*^9}, {3.724926718907716*^9, 3.724926728110176*^9}, 
   3.724926910047634*^9, {3.7249269410394907`*^9, 3.724926971750737*^9}, {
   3.724927038854178*^9, 3.724927083321466*^9}, {3.7286548296818857`*^9, 
   3.728654853038315*^9}, 3.7307265126133137`*^9, {3.73074323159988*^9, 
   3.730743236197591*^9}, {3.731672294849372*^9, 3.731672301449153*^9}, 
   3.7334568957805147`*^9, 3.73345737548673*^9, {3.830815574056407*^9, 
   3.830815574224642*^9}, {3.840757368485283*^9, 3.8407573922887697`*^9}, {
   3.840757477995492*^9, 3.840757478137701*^9}, 3.848885121729268*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"ff26c383-4821-4178-8d5b-e6ee8531debd"],

Cell[CellGroupData[{

Cell["General rules", "Subsubsection",
 CellChangeTimes->{{3.7026574679806843`*^9, 3.702657471181635*^9}, {
  3.703213600099868*^9, 
  3.703213600794937*^9}},ExpressionUUID->"b5ffae47-519f-40db-bd8c-\
5a3e3dd10c9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EliminateDualRules", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Ftc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{"Ftc", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Fc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{"Fc", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Ftc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", "c", "]"}], "[", 
           RowBox[{"Ftc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Fc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", "c", "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Fc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", "c", "]"}], "[", 
           RowBox[{"Ftc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Ftc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", "c", "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Ftc", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", "c"}], "]"}], " ", 
          RowBox[{"Ftc", "[", 
           RowBox[{
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "c"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Fc", "[", 
             RowBox[{
              RowBox[{"-", "a"}], ",", "c"}], "]"}]}], " ", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "b"}], ",", 
             RowBox[{"-", "c"}]}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"gmn", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], " ", 
           RowBox[{"Fc", "[", 
            RowBox[{"c", ",", "d"}], "]"}], " ", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "c"}], ",", 
             RowBox[{"-", "d"}]}], "]"}]}]}]}], "}"}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BianchiRules", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RiemannCD", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], " ", 
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}], ",", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"RiemannCD", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], " ", 
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"CD", "[", "b", "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{"a", ",", "c"}], "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", 
            RowBox[{"-", "c"}], "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{
           RowBox[{"CD", "[", "c", "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", 
            RowBox[{"-", "c"}], "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Fc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{"Fc", "[", 
           RowBox[{"c", ",", "d"}], "]"}], " ", 
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}], ",", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"Fc", "[", 
           RowBox[{"a", ",", "b"}], "]"}], " ", 
          RowBox[{"Fc", "[", 
           RowBox[{"c", ",", "d"}], "]"}], " ", 
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Fc", "[", 
           RowBox[{"c", ",", "b"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", 
            RowBox[{"-", "c"}], "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "a"}], ",", 
             RowBox[{"-", "b"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"Fc", "[", 
           RowBox[{"b", ",", "c"}], "]"}], " ", 
          RowBox[{
           RowBox[{"CD", "[", 
            RowBox[{"-", "a"}], "]"}], "[", 
           RowBox[{"Fc", "[", 
            RowBox[{
             RowBox[{"-", "b"}], ",", 
             RowBox[{"-", "c"}]}], "]"}], "]"}]}]}], "}"}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FcDualRule", "=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftc", "[", 
        RowBox[{
         RowBox[{"-", "a"}], ",", 
         RowBox[{"-", "b"}]}], "]"}], ",", 
       RowBox[{
        FractionBox["1", "2"], "  ", 
        RowBox[{"epsilongmn", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "d"}]}], "]"}], " ", 
        RowBox[{"Fc", "[", 
         RowBox[{"c", ",", "d"}], "]"}]}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SchoutenRules", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"MakeRule", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Fc", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "c"}]}], "]"}], " ", 
        RowBox[{"Ftc", "[", 
         RowBox[{
          RowBox[{"-", "b"}], ",", "c"}], "]"}]}], ",", 
       RowBox[{
        FractionBox["1", "4"], 
        RowBox[{"gmn", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}]}], "]"}], " ", 
        RowBox[{"Fc", "[", 
         RowBox[{
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "d"}]}], "]"}], " ", 
        RowBox[{"Ftc", "[", 
         RowBox[{"c", ",", "d"}], "]"}]}]}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7026574911509523`*^9, 3.702657495914809*^9}, {
   3.702657932860476*^9, 3.7026579331266623`*^9}, 3.703322872778656*^9, {
   3.718208243952919*^9, 3.71820826113721*^9}, 3.718208369125463*^9, {
   3.718208405363379*^9, 3.7182084075419416`*^9}, {3.718208446576852*^9, 
   3.718208456200736*^9}, {3.718208688292758*^9, 3.7182086905499697`*^9}, {
   3.724924964049069*^9, 3.724924975461123*^9}, 3.724925245988106*^9, {
   3.731672064887727*^9, 3.7316721145545893`*^9}, {3.731672726863368*^9, 
   3.73167273041881*^9}, {3.8488832435523643`*^9, 3.848883256262478*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"542242ff-41f3-4be2-8810-62737cc19a43"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Quadratic fluctuations", "Subsection",
 CellChangeTimes->{{3.696836794383073*^9, 
  3.696836816199692*^9}},ExpressionUUID->"216a38c3-f3ef-42e4-9a0e-\
08429d2fd82b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FluctuationsGravity", "[", 
     RowBox[{
     "lgr_", ",", "gaugeFields_", ",", "tgaugeFields_", ",", "gaugeVecs_", 
      ",", "scalars_", ",", "gaugeRenF_", ",", "scalRenF_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fluct", ",", "quadfluct", ",", "killSec", ",", 
        StyleBox["gauge",
         FontFamily->"Courier"], ",", 
        StyleBox["redef",
         FontFamily->"Courier"], 
        StyleBox[",",
         FontFamily->"Courier"], 
        StyleBox["traceless",
         FontFamily->"Courier"], 
        StyleBox[",",
         FontFamily->"Courier"], "normToSquare", ",", 
        StyleBox["gaugeRedef",
         FontFamily->"Courier"], 
        StyleBox[",",
         FontFamily->"Courier"], "renormVec1", ",", "renormVec2", ",", 
        "renormScal1", ",", "renormScal2", ",", "gRF0", ",", "gRF1", ",", 
        "sRF0", ",", "sRF1", ",", 
        StyleBox["nG",
         FontFamily->"Courier"], 
        StyleBox[",",
         FontFamily->"Courier"], 
        StyleBox["nS",
         FontFamily->"Courier"]}], 
       StyleBox["}",
        FontFamily->"Courier"]}], 
      StyleBox[",",
       FontFamily->"Courier"], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nG", "=", 
        RowBox[{"Length", "[", "gaugeFields", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nS", "=", 
        RowBox[{"Length", "[", "scalars", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killSec", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hmn", "[", 
           RowBox[{
            RowBox[{"LI", "[", "2", "]"}], ",", "__"}], "]"}], "\[Rule]", " ",
           "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killSec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"killSec", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"gaugeFields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"LI", "[", "2", "]"}], ",", "__"}], "]"}], "\[Rule]", 
             " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"killSec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"killSec", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tgaugeFields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"LI", "[", "2", "]"}], ",", "__"}], "]"}], "\[Rule]", 
             " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"killSec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"killSec", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"scalars", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"LI", "[", "2", "]"}], "]"}], "\[Rule]", " ", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nS"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"normToSquare", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"norm", "[", 
             RowBox[{
              RowBox[{"scalars", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}], "]"}], "\[Rule]", 
           " ", 
           RowBox[{
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], 
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nS"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"normToSquare", ",", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"norm", "[", 
            RowBox[{"ks", "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}], "]"}], "\[Rule]", 
          " ", 
          RowBox[{
           RowBox[{"ks", "[", 
            RowBox[{"LI", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"ks", "[", 
            RowBox[{"LI", "[", "1", "]"}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        StyleBox["gauge",
         FontFamily->"Courier"], 
        StyleBox["=",
         FontFamily->"Courier"], 
        RowBox[{
         StyleBox["MakeRule",
          FontFamily->"Courier"], 
         StyleBox["[",
          FontFamily->"Courier"], 
         RowBox[{
          StyleBox["{",
           FontFamily->"Courier"], 
          RowBox[{
           StyleBox[
            RowBox[{
             RowBox[{"CD", "[", "a", "]"}], "[", 
             RowBox[{"hmn", "[", 
              RowBox[{
               RowBox[{"LI", "[", "1", "]"}], ",", 
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "b"}]}], "]"}], "]"}],
            FontFamily->"Courier"], 
           StyleBox[",",
            FontFamily->"Courier"], 
           RowBox[{
            FractionBox[
             StyleBox["1",
              FontFamily->"Courier"], "2"], 
            StyleBox[
             RowBox[{
              RowBox[{"CD", "[", 
               RowBox[{"-", "b"}], "]"}], "[", 
              RowBox[{"hmn", "[", 
               RowBox[{
                RowBox[{"LI", "[", "1", "]"}], ",", 
                RowBox[{"-", "d"}], ",", "d"}], "]"}], "]"}],
             FontFamily->"Courier"]}]}], 
          StyleBox["}",
           FontFamily->"Courier"]}], 
         StyleBox["]",
          FontFamily->"Courier"]}]}], 
       StyleBox[";",
        FontFamily->"Courier"], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier"], 
       RowBox[{
        StyleBox["redef",
         FontFamily->"Courier"], 
        StyleBox["=",
         FontFamily->"Courier"], 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MakeRule", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"hmn", "[", 
              RowBox[{
               RowBox[{"LI", "[", "1", "]"}], ",", 
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "b"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               SqrtBox["2"], 
               RowBox[{"kmn", "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                SqrtBox["2"], "2"], "I", " ", "swickGravity", " ", 
               RowBox[{"ks", "[", 
                RowBox[{"LI", "[", "1", "]"}], "]"}], 
               RowBox[{"gmn", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}]}]}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MakeRule", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"hmn", "[", 
              RowBox[{
               RowBox[{"LI", "[", "1", "]"}], ",", 
               RowBox[{"-", "a"}], ",", "a"}], "]"}], ",", 
             RowBox[{"2", 
              SqrtBox["2"], "I", " ", "swickGravity", " ", 
              RowBox[{"ks", "[", 
               RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], "}"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"traceless", "=", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kmn", "[", 
            RowBox[{
             RowBox[{"LI", "[", "1", "]"}], ",", 
             RowBox[{"-", "a"}], ",", "a"}], "]"}], ",", "0"}], "}"}], 
         "]"}]}], ";", 
       RowBox[{"gaugeRedef", "=", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"CD", "[", "a", "]"}], "[", 
            RowBox[{"kmn", "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "b"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["I", "2"]}], " ", "swickGravity", " ", 
            RowBox[{
             RowBox[{"CD", "[", 
              RowBox[{"-", "b"}], "]"}], "[", 
             RowBox[{"ks", "[", 
              RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}]}], "}"}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"gRF0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nG"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sRF0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nS"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"gRF0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"gaugeRenF", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], "/.", "BackSimp"}],
             "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"sRF0", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"scalRenF", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], "/.", "BackSimp"}],
             "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"renormScal1", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MakeRule", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"sRF0", "[", 
                RowBox[{"[", "i", "]"}], "]"}], 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"renormVec1", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MakeRule", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"gaugeFields", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], "]"}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"gRF0", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", 
                 RowBox[{
                  RowBox[{"gaugeFields", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CD", "[", 
                   RowBox[{"-", "a"}], "]"}], "[", 
                  RowBox[{"gRF0", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], 
                 RowBox[{
                  RowBox[{"gaugeVecs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{
                  RowBox[{"CD", "[", 
                   RowBox[{"-", "b"}], "]"}], "[", 
                  RowBox[{"gRF0", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], 
                 RowBox[{
                  RowBox[{"gaugeVecs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "a"}]}], "]"}]}]}], "]"}]}], "}"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "expansions", " ", "gives", " ", "in", " ", "fact", " ", 
          "2", " ", "times", " ", "the", " ", "expanded", " ", "second", " ", 
          "order", " ", "piece"}], ",", " ", 
         RowBox[{"so", " ", "we", " ", "divive", " ", "by", " ", "2"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Detgmn", "[", "]"}], "]"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ExpandPerturbation", "@", 
             RowBox[{"Perturbation", "[", 
              RowBox[{"lgr", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"ExpandPerturbation", "@", 
              RowBox[{"Perturbation", "[", 
               RowBox[{"lgr", ",", "2"}], "]"}]}]}]}], ")"}]}], "/.", 
         "BackSimp"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{"fluct", 
         RowBox[{"(*", 
          RowBox[{"/.", "gauge"}], "*)"}], "//", "Simp"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{
         RowBox[{"fluct", "/.", "redef"}], "//", "Simp"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fluct", "/.", "traceless"}], 
          RowBox[{"(*", 
           RowBox[{"/.", "gaugeRedef"}], "*)"}], "//", "Simp"}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{"fluct", "/.", "DualVecFluctRules"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{"fluct", "/.", "renormVec1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"fluct", "/.", "renormScal1"}], "//", "Simp"}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "norm", " ", "terms", " ", "are", " ", "considered", " ", "to", " ", 
         "be", " ", "order", " ", "zero", " ", "so", " ", "we", " ", 
         "replace", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{
         RowBox[{"fluct", "/.", "normToSquare"}], "/.", "killSec"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fluct", "=", 
        RowBox[{"fluct", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"quadfluct", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"select", " ", "order", " ", "2"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PerturbationOrder", "[", 
             RowBox[{"fluct", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", "2"}], ",", 
           RowBox[{"quadfluct", "+=", 
            RowBox[{"fluct", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "fluct", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"quadfluct", "//", "Simp"}], "//", "Expand"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComputeOp", "[", 
     RowBox[{
     "fluct_", ",", "isGravity_", ",", "gaugeFields_", ",", "gaugeVecs_", ",",
       "scalars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nG", ",", " ", "nS", ",", "ResP", ",", "Resom", ",", "ListDone", ",", 
        "M", ",", "pattern", ",", "offG"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nG", "=", 
        RowBox[{"Length", "[", "gaugeFields", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nS", "=", 
        RowBox[{"Length", "[", "scalars", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"offG", "=", 
        RowBox[{"If", "[", 
         RowBox[{"isGravity", ",", "2", ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ResP", "=", 
        RowBox[{"0", " ", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"offG", "+", "nG", "+", "nS"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Resom", "=", 
        RowBox[{"0", " ", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"offG", "+", "nG", "+", "nS"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListDone", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"isGravity", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+=", 
           RowBox[{
            RowBox[{"2", "  ", 
             RowBox[{"RicciCD", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "c"}]}], "]"}], 
             RowBox[{"gmn", "[", 
              RowBox[{
               RowBox[{"-", "b"}], ",", 
               RowBox[{"-", "d"}]}], "]"}]}], "+", 
            RowBox[{"2", "  ", 
             RowBox[{"RiemannCD", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "c"}], ",", 
               RowBox[{"-", "b"}], ",", 
               RowBox[{"-", "d"}]}], "]"}]}], "-", " ", 
            RowBox[{
             RowBox[{"RicciScalarCD", "[", "]"}], " ", 
             RowBox[{"gmn", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "c"}]}], "]"}], 
             RowBox[{"gmn", "[", 
              RowBox[{
               RowBox[{"-", "b"}], ",", 
               RowBox[{"-", "d"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "+=", 
           RowBox[{"I", " ", "swickGravity", " ", 
            RowBox[{"RicciScalarCD", "[", "]"}], 
            RowBox[{"gmn", "[", 
             RowBox[{
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "b"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            SubscriptBox["k", "\[Mu]\[Nu]"], " ", 
            SubscriptBox["k", "\[Rho]\[Sigma]"]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+=", 
           RowBox[{"Lower", "[", 
            RowBox[{
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", 
               RowBox[{
                RowBox[{"kmn", "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", 
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{"-", "b"}]}], "]"}], 
                RowBox[{"kmn", "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", 
                  RowBox[{"-", "c"}], ",", 
                  RowBox[{"-", "d"}]}], "]"}]}]}], "]"}], "//", "Simp"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"kmn", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}], 
                 RowBox[{"kmn", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "c"}], ",", 
                   RowBox[{"-", "d"}]}], "]"}]}], ",", "0"}], "}"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            SubscriptBox["k", "\[Mu]\[Nu]"], " ", "k"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "+=", " ", 
           RowBox[{"Lower", "[", 
            RowBox[{
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", 
               RowBox[{
                RowBox[{"kmn", "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", 
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{"-", "b"}]}], "]"}], 
                RowBox[{"ks", "[", 
                 RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], "]"}], "//", 
             "Simp"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"kmn", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}], 
                 RowBox[{"ks", "[", 
                  RowBox[{"LI", "[", "1", "]"}], "]"}]}], ",", "0"}], "}"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"k", " ", "k"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+=", 
           RowBox[{"Lower", "[", 
            RowBox[{
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", 
               RowBox[{"norm", "[", 
                RowBox[{"ks", "[", 
                 RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}], "]"}], "//", 
             "Simp"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"norm", "[", 
                RowBox[{"ks", "[", 
                 RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
               "0"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            SubscriptBox["k", "\[Mu]\[Nu]"], " ", 
            RowBox[{
             SubscriptBox["\[PartialD]", "\[Sigma]"], 
             SubscriptBox["a", "\[Rho]"]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"NumberQ", "[", 
                RowBox[{"gaugeFields", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pattern", "=", 
                RowBox[{
                 RowBox[{"kmn", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"gaugeFields", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "c"}], ",", 
                   RowBox[{"-", "d"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"M", "=", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"Lower", "[", 
                  RowBox[{"IndexCoefficient", "[", 
                   RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Resom", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "+=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"M", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], 
                    "]"}], "-", "M"}], ")"}]}], "//", "Simp"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ListDone", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"ListDone", ",", 
                    RowBox[{"MakeRule", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            SubscriptBox["k", "\[Mu]\[Nu]"], " ", 
            SubscriptBox["a", "\[Rho]"]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{
               RowBox[{"kmn", "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "c"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"ResP", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "+=", 
              RowBox[{"Lower", "[", 
               RowBox[{
                RowBox[{"IndexCoefficient", "[", 
                 RowBox[{"fluct", ",", "pattern"}], "]"}], "//", "Simp"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ListDone", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"ListDone", ",", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                  "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"k", " ", 
            RowBox[{
             SubscriptBox["\[PartialD]", "\[Nu]"], 
             SubscriptBox["a", "\[Mu]"]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"NumberQ", "[", 
                 RowBox[{"gaugeFields", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pattern", "=", 
                 RowBox[{
                  RowBox[{"ks", "[", 
                   RowBox[{"LI", "[", "1", "]"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{"gaugeFields", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"LI", "[", "1", "]"}], ",", 
                    RowBox[{"-", "a"}], ",", 
                    RowBox[{"-", "b"}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"M", "=", 
                 RowBox[{
                  FractionBox["1", "2"], " ", 
                  RowBox[{"Lower", "[", 
                   RowBox[{"IndexCoefficient", "[", 
                    RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Resom", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "+=", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "[", 
                    RowBox[{"M", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "-", "M"}], 
                    ")"}]}], "//", "Simp"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"ListDone", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"ListDone", ",", 
                    RowBox[{"MakeRule", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], "]"}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            SubscriptBox["k", "\[Mu]\[Nu]"], " ", "\[Phi]"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{
               RowBox[{"kmn", "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ResP", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "+=", 
              RowBox[{"Lower", "[", 
               RowBox[{
                RowBox[{"IndexCoefficient", "[", 
                 RowBox[{"fluct", ",", "pattern"}], "]"}], "//", "Simp"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ListDone", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"ListDone", ",", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                  "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["k", "\[Mu]\[Nu]"], " ", 
             RowBox[{
              SubscriptBox["\[PartialD]", "\[Alpha]"], "\[Phi]"}]}], ")"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{
               RowBox[{"kmn", "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], 
               RowBox[{
                RowBox[{"CD", "[", 
                 RowBox[{"-", "c"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"scalars", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"M", "=", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Lower", "[", 
                RowBox[{"IndexCoefficient", "[", 
                 RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Resom", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", 
                    RowBox[{"offG", "+", "nG", "+", "i"}]}], "]"}], "]"}], "+=",
                  "M"}], ";", "\[IndentingNewLine]", 
                RowBox[{"ListDone", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"ListDone", ",", 
                   RowBox[{"MakeRule", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{
              SubscriptBox["\[PartialD]", "\[Alpha]"], "\[Phi]"}]}], ")"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{
               RowBox[{"ks", "[", 
                RowBox[{"LI", "[", "1", "]"}], "]"}], 
               RowBox[{
                RowBox[{"CD", "[", 
                 RowBox[{"-", "a"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"scalars", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"M", "=", 
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"Lower", "[", 
                RowBox[{"IndexCoefficient", "[", 
                 RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Resom", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", 
                    RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "+=", 
                 " ", "M"}], ";", "\[IndentingNewLine]", 
                RowBox[{"ListDone", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"ListDone", ",", 
                   RowBox[{"MakeRule", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         SubscriptBox["f", "\[Mu]\[Nu]"], " ", 
         SubscriptBox["f", "\[Mu]\[Nu]"]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"NumberQ", "[", 
              RowBox[{"gaugeFields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{"norm", "[", 
               RowBox[{
                RowBox[{"gaugeFields", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ResP", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"offG", "+", "i"}], ",", 
                 RowBox[{"offG", "+", "i"}]}], "]"}], "]"}], "+=", 
              RowBox[{"2", " ", 
               RowBox[{"Coefficient", "[", 
                RowBox[{"fluct", ",", "pattern"}], "]"}], " ", 
               RowBox[{"RicciCD", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"AppendTo", "[", 
              RowBox[{"ListDone", ",", 
               RowBox[{"pattern", "\[Rule]", "0"}]}], "]"}], ";"}]}], "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{"\[Phi]", " ", "\[Lambda]"}], ")"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], 
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
              RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "+=", 
           RowBox[{"Lower", "[", 
            RowBox[{
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "//", "Simp"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], "}"}], 
              "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nS"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "nS"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{"\[Phi]", " ", "\[Phi]"}], ")"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{"norm", "[", 
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ResP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "i"}]}], "]"}], "]"}], "+=", 
            " ", 
            RowBox[{"Coefficient", "[", 
             RowBox[{"fluct", ",", "pattern"}], "]"}]}], "//", "Simp"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"pattern", "\[Rule]", "0"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["a", "\[Mu]"], " ", 
          SubscriptBox["a", "\[Nu]"]}], ")"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}]}], "]"}], 
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "b"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"offG", "+", "i"}], ",", 
              RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "+=", 
           RowBox[{"Lower", "[", 
            RowBox[{
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "//", "Simp"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], "}"}], 
              "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["a", "\[Mu]"], " ", "\[Phi]"}], ")"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}]}], "]"}], 
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ResP", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"offG", "+", "i"}], ",", 
              RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "+=", 
           RowBox[{"Lower", "[", 
            RowBox[{
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "//", "Simp"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListDone", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"ListDone", ",", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], "}"}], 
              "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nS"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["a", "\[Mu]"], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Nu]"], "\[Phi]"}]}], ")"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}]}], "]"}], 
            RowBox[{
             RowBox[{"CD", "[", 
              RowBox[{"-", "b"}], "]"}], "[", 
             RowBox[{
              RowBox[{"scalars", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"Lower", "[", 
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Resom", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"offG", "+", "i"}], ",", 
                 RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "+=", 
              "M"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ListDone", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"ListDone", ",", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                  "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nS"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{"\[Phi]", " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Nu]"], 
           SubscriptBox["a", "\[Mu]"]}]}], ")"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"NumberQ", "[", 
              RowBox[{"gaugeFields", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"LI", "[", "1", "]"}], "]"}], 
               RowBox[{
                RowBox[{"gaugeFields", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"M", "=", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Lower", "[", 
                RowBox[{"IndexCoefficient", "[", 
                 RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Resom", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
                    RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "+=", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "-", "M"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"ListDone", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"ListDone", ",", 
                   RowBox[{"MakeRule", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nS"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Phi]", " ", 
           RowBox[{
            SubscriptBox["\[PartialD]", "\[Nu]"], 
            SubscriptBox["a", "\[Mu]"]}]}], ")"}], " ", "without", " ", 
         SubscriptBox["f", "\[Nu]\[Rho]"]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], 
            RowBox[{
             RowBox[{"CD", "[", 
              RowBox[{"-", "b"}], "]"}], "[", 
             RowBox[{
              RowBox[{"gaugeVecs", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"LI", "[", "1", "]"}], ",", 
               RowBox[{"-", "a"}]}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"Lower", "[", 
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Resom", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
                 RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "+=", "M"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"ListDone", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"ListDone", ",", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                  "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nS"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["a", "\[Mu]"], " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Rho]"], 
           SubscriptBox["a", "\[Nu]"]}]}], ")"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"NumberQ", "[", 
              RowBox[{"gaugeFields", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pattern", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}]}], "]"}], 
               RowBox[{
                RowBox[{"gaugeFields", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "b"}], ",", 
                 RowBox[{"-", "c"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"M", "=", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Lower", "[", 
                RowBox[{"IndexCoefficient", "[", 
                 RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Resom", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"offG", "+", "i"}], ",", 
                    RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "+=", 
                 RowBox[{"(*", 
                  RowBox[{"t", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "*)"}], 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"M", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], "-", 
                  "M"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"ListDone", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"ListDone", ",", 
                   RowBox[{"MakeRule", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                    "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["a", "\[Mu]"], " ", 
           RowBox[{
            SubscriptBox["\[PartialD]", "\[Rho]"], 
            SubscriptBox["a", "\[Nu]"]}]}], ")"}], " ", "without", " ", 
         SubscriptBox["f", "\[Nu]\[Rho]"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}]}], "]"}], 
            RowBox[{
             RowBox[{"CD", "[", 
              RowBox[{"-", "c"}], "]"}], "[", 
             RowBox[{
              RowBox[{"gaugeVecs", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{
               RowBox[{"LI", "[", "1", "]"}], ",", 
               RowBox[{"-", "b"}]}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"Lower", "[", 
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Resom", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"offG", "+", "i"}], ",", 
                 RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "+=", "M"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"ListDone", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"ListDone", ",", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                  "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nG"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nG"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", " ", 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Alpha]"], "\[Phi]"}]}], ")"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pattern", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], 
            RowBox[{
             RowBox[{"CD", "[", 
              RowBox[{"-", "a"}], "]"}], "[", 
             RowBox[{
              RowBox[{"scalars", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"LI", "[", "1", "]"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"Lower", "[", 
             RowBox[{"IndexCoefficient", "[", 
              RowBox[{"fluct", ",", "pattern"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Spin", "[", "M", "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Resom", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
                 RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "+=", 
              "M"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ListDone", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"ListDone", ",", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "[", "pattern", "]"}], ",", "0"}], 
                  "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nS"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nS"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Remaining: \>\"", " ", ",", " ", 
         RowBox[{
          RowBox[{"fluct", "/.", "ListDone"}], "//", "SDI"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ResP", ",", "Resom"}], "}"}], "//", "Simp"}], "//", 
         "SDI"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CheckOpFluct", "[", 
     RowBox[{
     "fluct_", ",", "rawP_", ",", "rawom_", ",", "isGravity_", ",", 
      "gaugeFields_", ",", "gaugeVecs_", ",", "scalars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cfluct", ",", "P", ",", "fields", ",", "base", ",", "nG", ",", "nS", 
        ",", "ConvertToVec", ",", "gaugFixTerm", ",", "IPPVec", ",", 
        "tokin"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nG", "=", 
        RowBox[{"Length", "[", "gaugeFields", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nS", "=", 
        RowBox[{"Length", "[", "scalars", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"base", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nS"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fields", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"kmn", "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "b"}]}], "]"}], ",", 
            RowBox[{"ks", "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", 
              RowBox[{"-", "a"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"scalars", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"LI", "[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nS"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"gaugFixTerm", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"CD", "[", 
             RowBox[{"-", "a"}], "]"}], "[", 
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", "a"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"CD", "[", 
             RowBox[{"-", "b"}], "]"}], "[", 
            RowBox[{
             RowBox[{"gaugeVecs", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{
              RowBox[{"LI", "[", "1", "]"}], ",", "b"}], "]"}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"i", ",", "nG"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ConvertToVec", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MakeRule", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"gaugeFields", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"LI", "[", "1", "]"}], ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"CD", "[", 
                 RowBox[{"-", "a"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"gaugeVecs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", 
                  RowBox[{"-", "b"}]}], "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"CD", "[", 
                 RowBox[{"-", "b"}], "]"}], "[", 
                RowBox[{
                 RowBox[{"gaugeVecs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", 
                  RowBox[{"-", "a"}]}], "]"}], "]"}]}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IPPVec", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MakeRule", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"CD", "[", 
                 RowBox[{"-", "a"}], "]"}], "[", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"gaugeVecs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}], "]"}], "]"}], 
               RowBox[{
                RowBox[{"CD", "[", "b", "]"}], "[", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"gaugeVecs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", "a"}], "]"}], "]"}], 
                "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"RicciCD", "[", 
                  RowBox[{
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "b"}]}], "]"}]}], 
                RowBox[{
                 RowBox[{"gaugeVecs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", "a"}], "]"}], 
                RowBox[{
                 RowBox[{"gaugeVecs", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{"LI", "[", "1", "]"}], ",", "b"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"CD", "[", 
                  RowBox[{"-", "a"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{"gaugeVecs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", "a"}], "]"}], "]"}], 
                RowBox[{
                 RowBox[{"CD", "[", 
                  RowBox[{"-", "b"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{"gaugeVecs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", "b"}], "]"}], 
                 "]"}]}]}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"P", "=", "rawP"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "-=", 
        RowBox[{
         RowBox[{"2", "  ", 
          RowBox[{"RicciCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "c"}]}], "]"}], 
          RowBox[{"gmn", "[", 
           RowBox[{
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}], "+", 
         RowBox[{"2", "  ", 
          RowBox[{"RiemannCD", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}], "-", " ", 
         RowBox[{
          RowBox[{"RicciScalarCD", "[", "]"}], " ", 
          RowBox[{"gmn", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "c"}]}], "]"}], 
          RowBox[{"gmn", "[", 
           RowBox[{
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "d"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "-=", 
        RowBox[{"I", " ", "swickGravity", " ", 
         RowBox[{"RicciScalarCD", "[", "]"}], 
         RowBox[{"gmn", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"cfluct", " ", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"multiDot", "[", 
           RowBox[{
            RowBox[{"multiDot", "[", 
             RowBox[{
              RowBox[{"P", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"fields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m", ",", "m"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", 
                  RowBox[{"base", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"fields", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", "m"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"base", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "base", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "base", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cfluct", " ", "+=", 
        RowBox[{"2", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"multiDot", "[", 
            RowBox[{
             RowBox[{"multiDot", "[", 
              RowBox[{
               RowBox[{"rawom", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"fields", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"m", ",", "m"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"base", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
              ",", 
             RowBox[{"covD", "[", 
              RowBox[{"fields", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m", ",", "m"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{
                  RowBox[{"base", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], "}"}]}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "base", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "base", "]"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tokin", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"fluct", "/.", "ConvertToVec"}], ")"}], "-", "cfluct", 
           "+", "gaugFixTerm"}], "//", "Simp"}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tokin", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"tokin", "/.", "IPPVec"}], "//", "Simp"}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Reconstruction of the fluctuation operator.\nRemains: \>\"", ",",
          "tokin"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WhichCouplings", "[", 
    RowBox[{
    "inP_", ",", "inom_", ",", "isGravity_", ",", "gaugeFields_", ",", 
     "gaugeVecs_", ",", "scalars_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "which", ",", "nS", ",", "nG", ",", "offG", ",", 
       "incidenceGraph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "inP", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"which", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nG", "=", 
       RowBox[{"Length", "[", "gaugeFields", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nS", "=", 
       RowBox[{"Length", "[", "scalars", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"offG", "=", 
       RowBox[{"If", "[", 
        RowBox[{"isGravity", ",", "2", ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"incidenceGraph", "=", 
       RowBox[{"0", 
        RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isGravity", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Spin", "[", 
             RowBox[{"inP", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ">", "0"}], ",", 
           
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
             "which", ",", 
              "\"\<\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\) \
\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\)\>\""}], "]"}], ";", 
            RowBox[{
             RowBox[{"incidenceGraph", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1"}], ";"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Spin", "[", 
             RowBox[{"inP", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], ">", "0"}], ",", 
           
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
             "which", ",", 
              "\"\<\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\) k\>\""}], 
             "]"}], ";", 
            RowBox[{
             RowBox[{"incidenceGraph", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", "1"}], ";"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"inP", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[NotEqual]", " ", 
            "0"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", "\"\<k k\>\""}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Spin", "[", 
               RowBox[{"inom", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
             ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"which", ",", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\) \
\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\>\"", ",", 
                  RowBox[{
                   RowBox[{"gaugeVecs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"incidenceGraph", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "=", "1"}], 
              ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Spin", "[", 
               RowBox[{"inP", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
             ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"which", ",", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\) ``\>\"", 
                  ",", 
                  RowBox[{
                   RowBox[{"gaugeVecs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"incidenceGraph", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "=", "1"}], 
              ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Spin", "[", 
               RowBox[{"inom", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", 
                  RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
             ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"which", ",", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<k \!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\
\>\"", ",", 
                  RowBox[{
                   RowBox[{"gaugeVecs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"incidenceGraph", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", 
                  RowBox[{"2", "+", "i"}]}], "]"}], "]"}], "=", "1"}], 
              ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nG"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Spin", "[", 
               RowBox[{"inP", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "]"}], 
              ">", "0"}], ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"which", ",", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\) ``\>\"", 
                  ",", 
                  RowBox[{
                   RowBox[{"scalars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"incidenceGraph", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "=", 
               "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Spin", "[", 
               RowBox[{"inom", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "]"}], 
              ">", "0"}], ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"which", ",", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<\!\(\*SubscriptBox[\(k\), \(\[Mu]\[Nu]\)]\) \
\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\>\"", ",", 
                  RowBox[{
                   RowBox[{"scalars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"incidenceGraph", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "=", 
               "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ks", "[", "]"}], "+", 
                RowBox[{"inom", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}]}], 
               "]"}], ">", " ", "0"}], ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"which", ",", 
                RowBox[{"StringForm", "[", 
                 RowBox[{
                 "\"\<k \!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\
\>\"", ",", 
                  RowBox[{
                   RowBox[{"scalars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], 
               "]"}], ";", 
              RowBox[{
               RowBox[{"incidenceGraph", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", 
                  RowBox[{"2", "+", "nG", "+", "i"}]}], "]"}], "]"}], "=", 
               "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nS"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"ks", "[", "]"}], "+", 
             RowBox[{"inP", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
                RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}]}], 
            "]"}], ">", " ", "0"}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<`` ``\>\"", ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "=", 
            "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nS"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "i", ",", "nS"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Spin", "[", 
            RowBox[{"inP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<`` ``\>\"", ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "=", "1"}], 
           ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nG"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "i", ",", "nG"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Spin", "[", 
            RowBox[{"inP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "]"}], 
           ">", "0"}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<`` ``\>\"", ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "=", 
            "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nG"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nS"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Spin", "[", 
            RowBox[{"inom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "]"}], 
           ">", "0"}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<`` \!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\>\
\"", ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "=", 
            "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nG"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nS"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Spin", "[", 
            RowBox[{"inom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<`` \!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\>\
\"", ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "=", "1"}], 
           ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nS"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nG"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Spin", "[", 
            RowBox[{"inom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "]"}], ">", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<`` \!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\>\
\"", ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"gaugeVecs", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "j"}]}], "]"}], "]"}], "=", "1"}], 
           ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nG"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nG"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Spin", "[", 
            RowBox[{"inom", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "]"}], 
           ">", "0"}], ",", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"which", ",", 
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<`` \!\(\*SubscriptBox[\(\[PartialD]\), \(\[Alpha]\)]\)``\>\
\"", ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}], ",", 
               RowBox[{
                RowBox[{"scalars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "]"}]}], "]"}]}], "]"}],
            ";", 
           RowBox[{
            RowBox[{"incidenceGraph", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"offG", "+", "nG", "+", "i"}], ",", 
               RowBox[{"offG", "+", "nG", "+", "j"}]}], "]"}], "]"}], "=", 
            "1"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nS"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "nS"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "incidenceGraph", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6964082855343227`*^9, 3.696408289305133*^9}, {
   3.696408486440646*^9, 3.696408496051062*^9}, {3.696408645060515*^9, 
   3.696408663557135*^9}, {3.696410311392951*^9, 3.696410324850418*^9}, {
   3.696415356596669*^9, 3.696415373044615*^9}, {3.696416297585588*^9, 
   3.69641630917212*^9}, {3.696416673905641*^9, 3.6964166902417793`*^9}, {
   3.6964167250110407`*^9, 3.696416750049761*^9}, {3.696417709979868*^9, 
   3.696417941206827*^9}, {3.696418025598662*^9, 3.696418059797942*^9}, {
   3.696418236039549*^9, 3.6964183671147842`*^9}, {3.696418409845564*^9, 
   3.696418448370912*^9}, {3.6964184796396837`*^9, 3.696418516831854*^9}, {
   3.696418674250139*^9, 3.696418707527837*^9}, {3.696418754574883*^9, 
   3.696418860741495*^9}, {3.696418898163432*^9, 3.6964189144691973`*^9}, {
   3.696418952331728*^9, 3.696418990800852*^9}, {3.6964191167356443`*^9, 
   3.6964191650622587`*^9}, {3.696419250547624*^9, 3.6964193701301813`*^9}, {
   3.6964194195877657`*^9, 3.696419427398684*^9}, {3.6964195304376507`*^9, 
   3.696419542330607*^9}, {3.696419866978849*^9, 3.696419903248851*^9}, {
   3.696420044005559*^9, 3.696420044262363*^9}, {3.6964200855887623`*^9, 
   3.696420089795434*^9}, {3.696420252866478*^9, 3.696420255720439*^9}, {
   3.696420486322806*^9, 3.696420497968133*^9}, {3.696420739987516*^9, 
   3.6964207601558857`*^9}, {3.696420822850482*^9, 3.6964209409413347`*^9}, {
   3.6964211079612627`*^9, 3.6964211713989067`*^9}, {3.696421279565621*^9, 
   3.696421282990244*^9}, {3.69642131559839*^9, 3.696421351913385*^9}, {
   3.696421400244089*^9, 3.696421450602768*^9}, {3.696421481190241*^9, 
   3.696421637375578*^9}, {3.696421672129694*^9, 3.696421674440941*^9}, {
   3.696421708675269*^9, 3.696421747201167*^9}, {3.696421791736018*^9, 
   3.6964218599951687`*^9}, {3.6964218961736403`*^9, 3.696421896324236*^9}, {
   3.696421956076603*^9, 3.696421967880481*^9}, {3.6964220075870657`*^9, 
   3.696422027292239*^9}, 3.6964223814454403`*^9, 3.696422538093316*^9, {
   3.696422583914379*^9, 3.696422601023201*^9}, {3.696423555213779*^9, 
   3.69642355590522*^9}, {3.6964236748902683`*^9, 3.6964236859915533`*^9}, {
   3.696424394152068*^9, 3.696424494832549*^9}, {3.696424564849329*^9, 
   3.696424564914461*^9}, {3.6964246639930477`*^9, 3.6964246644941063`*^9}, {
   3.696424746030456*^9, 3.6964247483373823`*^9}, {3.69642479051689*^9, 
   3.6964248322058372`*^9}, {3.6964250298663282`*^9, 3.696425187262019*^9}, {
   3.6964252984878817`*^9, 3.696425312062241*^9}, {3.696425398116468*^9, 
   3.696425499254409*^9}, {3.696425584349407*^9, 3.696425857149706*^9}, {
   3.696425931118677*^9, 3.6964259673063107`*^9}, {3.696428537641552*^9, 
   3.696428563264927*^9}, {3.6964291513778353`*^9, 3.696429154455818*^9}, {
   3.696429758003605*^9, 3.6964297945499563`*^9}, {3.696443894608074*^9, 
   3.696443922245151*^9}, {3.696445597006762*^9, 3.696445620100058*^9}, 
   3.696445657340682*^9, {3.696446120617919*^9, 3.696446123835693*^9}, {
   3.696446156912427*^9, 3.696446241497944*^9}, {3.696446275760997*^9, 
   3.696446275810067*^9}, {3.696446350991996*^9, 3.6964463887049723`*^9}, {
   3.696446428071211*^9, 3.696446526405425*^9}, {3.69644656734226*^9, 
   3.696446567840173*^9}, {3.696447473418159*^9, 3.696447474528347*^9}, {
   3.69644752642813*^9, 3.696447546849863*^9}, 3.696447582954811*^9, {
   3.69644771983847*^9, 3.696447721363319*^9}, 3.696447754427319*^9, 
   3.696447856516947*^9, {3.696448110587488*^9, 3.69644811877522*^9}, {
   3.696448515338537*^9, 3.696448544523134*^9}, {3.696479321955947*^9, 
   3.696479358291106*^9}, {3.696479391280116*^9, 3.6964794055308867`*^9}, {
   3.696479873966673*^9, 3.696479903685637*^9}, {3.6964799399274483`*^9, 
   3.6964799424123287`*^9}, {3.696479992020426*^9, 3.6964803122011213`*^9}, {
   3.696480352586227*^9, 3.6964803854402943`*^9}, {3.696480417217513*^9, 
   3.696480423556678*^9}, {3.6964805369620123`*^9, 3.6964805630173807`*^9}, {
   3.696480596024949*^9, 3.6964805965091543`*^9}, {3.6964806886421843`*^9, 
   3.696480692638916*^9}, {3.696480750730146*^9, 3.6964807870672693`*^9}, {
   3.696480982079855*^9, 3.6964810027913322`*^9}, 3.6964822048887453`*^9, 
   3.696483769286983*^9, {3.696483818475378*^9, 3.696483820599094*^9}, 
   3.696483855773486*^9, {3.696484021076118*^9, 3.6964840263304653`*^9}, 
   3.69648427695968*^9, {3.6964845420017233`*^9, 3.696484545247149*^9}, {
   3.696484697446254*^9, 3.696484739772698*^9}, {3.696485287921837*^9, 
   3.696485290636508*^9}, {3.69648535312012*^9, 3.696485391197907*^9}, 
   3.696485715373856*^9, {3.696485749889955*^9, 3.696485809381765*^9}, {
   3.696485855608314*^9, 3.696485858971583*^9}, {3.6964869724191437`*^9, 
   3.696487025847309*^9}, {3.6964874713680553`*^9, 3.696487474314745*^9}, {
   3.696491431403616*^9, 3.696491444684689*^9}, {3.6964920250750637`*^9, 
   3.696492128824011*^9}, {3.696492198958103*^9, 3.69649221235575*^9}, {
   3.696492284327071*^9, 3.6964923005163717`*^9}, {3.696493003408743*^9, 
   3.696493067222681*^9}, {3.696493099677853*^9, 3.696493150092402*^9}, {
   3.6964932293488092`*^9, 3.696493382884995*^9}, {3.6964936166171007`*^9, 
   3.696493652851994*^9}, {3.696493914782753*^9, 3.696494011029475*^9}, {
   3.696494099458425*^9, 3.69649411243097*^9}, {3.696494146269987*^9, 
   3.69649434231607*^9}, {3.69649441724675*^9, 3.696494506855879*^9}, {
   3.696494553545443*^9, 3.696494553686365*^9}, {3.696495275342057*^9, 
   3.69649533562993*^9}, {3.696500373237403*^9, 3.696500390493107*^9}, {
   3.696500528824725*^9, 3.696500603556925*^9}, {3.696500636645034*^9, 
   3.696500895422721*^9}, {3.696500937509089*^9, 3.69650106576088*^9}, {
   3.696501342609457*^9, 3.696501457805807*^9}, {3.6965016104289913`*^9, 
   3.696501682549941*^9}, {3.696501880635901*^9, 3.696501892443563*^9}, {
   3.696501955275936*^9, 3.6965019748566217`*^9}, {3.696502361064151*^9, 
   3.6965023877467422`*^9}, {3.69650241947747*^9, 3.696502450565196*^9}, {
   3.6965025332004642`*^9, 3.696502560599349*^9}, {3.696502617062194*^9, 
   3.696502661219015*^9}, {3.696502696044241*^9, 3.69650271108393*^9}, {
   3.696507888372323*^9, 3.696507904605297*^9}, {3.696509926729197*^9, 
   3.6965099888933764`*^9}, {3.696510026598463*^9, 3.696510115956575*^9}, {
   3.69651253319881*^9, 3.696512611095808*^9}, 3.6965172646349373`*^9, {
   3.6965200701451*^9, 3.696520070400082*^9}, {3.696520137194696*^9, 
   3.6965201386768084`*^9}, {3.696520234063693*^9, 3.6965202341948633`*^9}, {
   3.696524853804335*^9, 3.696524885042535*^9}, {3.696524927668399*^9, 
   3.69652495667887*^9}, {3.696538930078396*^9, 3.696538931365758*^9}, {
   3.6965656200155907`*^9, 3.69656562493222*^9}, {3.696566913918676*^9, 
   3.696566920484667*^9}, {3.696566968515994*^9, 3.696566968733061*^9}, {
   3.696567147993762*^9, 3.69656714923387*^9}, {3.696569909914576*^9, 
   3.696570017334928*^9}, {3.69657018609091*^9, 3.6965702437704153`*^9}, {
   3.6965703987314672`*^9, 3.696570398854089*^9}, {3.696571601563653*^9, 
   3.6965716380264893`*^9}, {3.6965749394524384`*^9, 3.69657494120262*^9}, {
   3.696575013764188*^9, 3.696575028227265*^9}, {3.696575163528603*^9, 
   3.6965752023565063`*^9}, {3.696575630618142*^9, 3.6965757296546173`*^9}, {
   3.696575770121348*^9, 3.696575771485355*^9}, {3.6965758107371473`*^9, 
   3.6965759540182123`*^9}, {3.696576074549245*^9, 3.696576325887918*^9}, {
   3.696576370248109*^9, 3.696576382069615*^9}, {3.696576456020361*^9, 
   3.6965764820353737`*^9}, {3.696576618731735*^9, 3.696576655157585*^9}, {
   3.696576708582181*^9, 3.696576801939311*^9}, {3.696576842877676*^9, 
   3.696576843042676*^9}, {3.696576882959734*^9, 3.696576884116935*^9}, {
   3.696576941223229*^9, 3.69657699248272*^9}, {3.696577073510092*^9, 
   3.696577075988352*^9}, {3.69657719103251*^9, 3.69657722270673*^9}, 
   3.6965772552548637`*^9, {3.696577294580491*^9, 3.696577401169426*^9}, {
   3.6965775271754723`*^9, 3.6965776104025803`*^9}, {3.696577643836236*^9, 
   3.6965776493310537`*^9}, 3.696578358328197*^9, 3.6965783905729933`*^9, {
   3.696579334510848*^9, 3.6965794582874002`*^9}, {3.6965834181096497`*^9, 
   3.696583442874401*^9}, {3.696583562544341*^9, 3.696583603958074*^9}, {
   3.696583658839945*^9, 3.69658374184999*^9}, {3.696583827840982*^9, 
   3.6965838538868437`*^9}, {3.696584002477539*^9, 3.696584057961071*^9}, {
   3.696584268904375*^9, 3.696584269057555*^9}, {3.6965861883783693`*^9, 
   3.69658619033491*^9}, {3.69658934133847*^9, 3.696589365222664*^9}, {
   3.6966002570887613`*^9, 3.696600322956833*^9}, {3.6966003706219997`*^9, 
   3.696600449414218*^9}, {3.696668990746211*^9, 3.696669039892902*^9}, {
   3.696675532066362*^9, 3.6966755329281797`*^9}, {3.696677272646955*^9, 
   3.696677275556685*^9}, {3.696678153688664*^9, 3.696678159350281*^9}, {
   3.696681330179969*^9, 3.696681347457328*^9}, {3.696681481176153*^9, 
   3.696681487709646*^9}, {3.6966815564839497`*^9, 3.6966815729000072`*^9}, {
   3.696681809413684*^9, 3.696681812972125*^9}, {3.696681915725222*^9, 
   3.6966819160753527`*^9}, {3.696682483857909*^9, 3.696682537185131*^9}, {
   3.6966888597060337`*^9, 3.696688865009225*^9}, {3.6966890861983337`*^9, 
   3.696689117035389*^9}, {3.696689163582181*^9, 3.69668919156787*^9}, {
   3.696689321360271*^9, 3.696689321574931*^9}, {3.696689729271236*^9, 
   3.69668973248002*^9}, {3.696689811395811*^9, 3.6966898314567823`*^9}, 
   3.696689870205183*^9, 3.696690179985341*^9, {3.69669056304562*^9, 
   3.6966905704957542`*^9}, {3.696690621690063*^9, 3.696690621806326*^9}, {
   3.696690729485796*^9, 3.696690729569694*^9}, {3.696691388182226*^9, 
   3.696691389273014*^9}, 3.696692041915167*^9, {3.696692162011791*^9, 
   3.696692220524839*^9}, {3.6966923176102533`*^9, 3.696692340374175*^9}, {
   3.696693031128627*^9, 3.696693058327091*^9}, {3.6966944502400093`*^9, 
   3.696694494369336*^9}, {3.696694526041314*^9, 3.696694566452888*^9}, 
   3.6966969344355583`*^9, {3.6966973814673967`*^9, 3.696697405531397*^9}, 
   3.696697655907463*^9, 3.696700791792932*^9, {3.6967009682686443`*^9, 
   3.696700983297963*^9}, {3.6967011537096148`*^9, 3.6967011563236437`*^9}, {
   3.696701311833363*^9, 3.69670131769232*^9}, {3.696702646052765*^9, 
   3.6967026855248413`*^9}, {3.696703016875908*^9, 3.696703028049781*^9}, {
   3.696703083444713*^9, 3.6967031175340347`*^9}, {3.6967031523428793`*^9, 
   3.6967031642624397`*^9}, {3.696703232086904*^9, 3.6967032383742743`*^9}, {
   3.696703335649461*^9, 3.696703337774864*^9}, {3.696703622456602*^9, 
   3.696703646716213*^9}, 3.696703723882106*^9, {3.696703783206128*^9, 
   3.696703817047845*^9}, {3.696703861610244*^9, 3.696703877847663*^9}, {
   3.6967040357037573`*^9, 3.6967040384563103`*^9}, {3.6967040992347317`*^9, 
   3.696704155753479*^9}, {3.696705199085271*^9, 3.696705205475296*^9}, {
   3.6967636143563967`*^9, 3.696763616241074*^9}, 3.696786851931406*^9, {
   3.696787452889236*^9, 3.6967876425147467`*^9}, {3.696787687907102*^9, 
   3.6967877450006723`*^9}, {3.6967878037437687`*^9, 
   3.6967878313526382`*^9}, {3.6968181479023314`*^9, 
   3.6968181481661386`*^9}, {3.6968182199853287`*^9, 3.69681823292738*^9}, {
   3.696818304230886*^9, 3.6968183048221197`*^9}, {3.696818444554435*^9, 
   3.696818457526001*^9}, {3.696818591564128*^9, 3.69681862774255*^9}, {
   3.696819065262835*^9, 3.696819118387006*^9}, {3.696819372893252*^9, 
   3.6968194091216917`*^9}, {3.696823666373165*^9, 3.696823684338459*^9}, {
   3.696823725580896*^9, 3.696823811794055*^9}, {3.6968293217580547`*^9, 
   3.696829429152009*^9}, {3.696829473769723*^9, 3.696829527416362*^9}, {
   3.696829610983955*^9, 3.696829613590156*^9}, {3.69682975412185*^9, 
   3.6968298335511017`*^9}, {3.696829865556549*^9, 3.696829918766677*^9}, {
   3.696829954758465*^9, 3.696829989673526*^9}, {3.69683662580954*^9, 
   3.696836678437743*^9}, 3.696836741698526*^9, {3.696836772853064*^9, 
   3.696836791727371*^9}, {3.696938757607394*^9, 3.696938780342506*^9}, {
   3.6969389553586283`*^9, 3.6969389991630898`*^9}, {3.696939044587049*^9, 
   3.696939045559432*^9}, {3.696943315879785*^9, 3.696943424874523*^9}, {
   3.6969434811002893`*^9, 3.6969435565043573`*^9}, {3.696943698284753*^9, 
   3.696943737804248*^9}, 3.6969437880999727`*^9, {3.69694385529878*^9, 
   3.6969439568153048`*^9}, {3.696943987414256*^9, 3.696944016134718*^9}, {
   3.696944367895358*^9, 3.696944491559949*^9}, {3.6969445237513514`*^9, 
   3.696944545221278*^9}, {3.6969452948170967`*^9, 3.696945302486199*^9}, {
   3.6969453644914837`*^9, 3.6969453770453568`*^9}, 3.6969459546035852`*^9, {
   3.696946106007162*^9, 3.696946149787298*^9}, {3.696946216028406*^9, 
   3.6969462271740923`*^9}, {3.696952249667699*^9, 3.69695226983927*^9}, {
   3.696971797306097*^9, 3.696971830154315*^9}, {3.696971882672493*^9, 
   3.696971884777776*^9}, {3.6969719324734898`*^9, 3.69697194432408*^9}, {
   3.696971975981983*^9, 3.696971978441436*^9}, {3.696972012057644*^9, 
   3.696972013222684*^9}, 3.696972179646921*^9, {3.6969994437394533`*^9, 
   3.696999757866302*^9}, {3.6969997959849253`*^9, 3.696999801473263*^9}, {
   3.696999849941512*^9, 3.697000583700612*^9}, {3.697000636872652*^9, 
   3.697000637090413*^9}, {3.69700069008515*^9, 3.697000873676736*^9}, {
   3.697000925221278*^9, 3.697000956935842*^9}, {3.6970020093505087`*^9, 
   3.697002085450087*^9}, {3.6970043270317497`*^9, 3.697004371628489*^9}, {
   3.697009695977157*^9, 3.697009714251584*^9}, {3.69700983333643*^9, 
   3.6970098352802963`*^9}, {3.6970098688249903`*^9, 
   3.6970098933417997`*^9}, {3.697009944780604*^9, 3.697009972814743*^9}, {
   3.697010141406836*^9, 3.697010209522596*^9}, 3.6970102542886887`*^9, {
   3.6970103057012663`*^9, 3.6970103419795313`*^9}, {3.6970106327292757`*^9, 
   3.6970106491807537`*^9}, {3.6970107220165873`*^9, 3.6970107718950243`*^9}, 
   3.697011221167933*^9, 3.69701144902314*^9, {3.697012407554708*^9, 
   3.697012429733824*^9}, {3.697019391546813*^9, 3.697019401168976*^9}, {
   3.6970202793973913`*^9, 3.697020280160224*^9}, {3.69702046778054*^9, 
   3.697020546965776*^9}, {3.697021403977709*^9, 3.697021426402576*^9}, {
   3.6970384345165577`*^9, 3.697038554002123*^9}, {3.6970386053066387`*^9, 
   3.697038609403511*^9}, {3.6970386453040743`*^9, 3.697038709796564*^9}, 
   3.697038742550584*^9, {3.6970387928086987`*^9, 3.697038797953371*^9}, {
   3.6970388514291973`*^9, 3.69703886032405*^9}, {3.6970389488606043`*^9, 
   3.697038949017192*^9}, {3.6970438868877993`*^9, 3.697043928465345*^9}, {
   3.697043966461282*^9, 3.697043969888507*^9}, {3.697044239550486*^9, 
   3.697044240398375*^9}, 3.697044286346525*^9, {3.6970443458783484`*^9, 
   3.697044371079844*^9}, {3.697044497078*^9, 3.697044522001563*^9}, {
   3.6970445948765993`*^9, 3.6970446040756283`*^9}, {3.6970461221106863`*^9, 
   3.6970461811570168`*^9}, {3.697046423217911*^9, 3.6970464310517597`*^9}, {
   3.697046515234476*^9, 3.697046574788775*^9}, {3.697046605142922*^9, 
   3.69704672652514*^9}, {3.6970483039245462`*^9, 3.6970489895603313`*^9}, {
   3.697049503559293*^9, 3.69704962939603*^9}, {3.697049845995308*^9, 
   3.697050202838992*^9}, 3.697050325166142*^9, {3.6970504555638742`*^9, 
   3.697050481761442*^9}, {3.69705078872818*^9, 3.69705082710249*^9}, 
   3.697051000227787*^9, 3.697051116695665*^9, {3.697051248934958*^9, 
   3.697051249383038*^9}, {3.697051327785789*^9, 3.697051365900984*^9}, {
   3.697051600204199*^9, 3.697051616606267*^9}, 3.697052186433915*^9, 
   3.6970522363945713`*^9, 3.697084039362483*^9, {3.6970844825301533`*^9, 
   3.697084483695981*^9}, 3.697084561766624*^9, 3.6970846433094*^9, {
   3.6970853926762867`*^9, 3.6970854195465193`*^9}, {3.697085462255793*^9, 
   3.697085475350662*^9}, {3.697085508471919*^9, 3.69708552104434*^9}, {
   3.697085564123192*^9, 3.697085630690391*^9}, {3.697085679112513*^9, 
   3.697085689552597*^9}, {3.697085720335485*^9, 3.6970857535686893`*^9}, {
   3.697085896499487*^9, 3.697085930575005*^9}, {3.6971011586430283`*^9, 
   3.697101177988613*^9}, {3.697101311564487*^9, 3.69710133321352*^9}, {
   3.697101445910886*^9, 3.697101464654991*^9}, {3.697101553780813*^9, 
   3.6971015539536*^9}, {3.6971050106882668`*^9, 3.697105017148797*^9}, {
   3.697108749770998*^9, 3.697108798286229*^9}, 3.69711515175805*^9, 
   3.697115235265747*^9, {3.697117256051428*^9, 3.697117257584074*^9}, {
   3.697117290287567*^9, 3.69711730436234*^9}, {3.697117365739415*^9, 
   3.697117401965225*^9}, {3.69711755917435*^9, 3.6971175597918158`*^9}, {
   3.697212174320692*^9, 3.697212177382886*^9}, {3.697277981444765*^9, 
   3.697277985455824*^9}, 3.6972831218619423`*^9, 3.697283158730212*^9, {
   3.697283930188468*^9, 3.697283960301552*^9}, {3.697284653522624*^9, 
   3.6972846557637453`*^9}, {3.697442100796805*^9, 3.697442106849098*^9}, {
   3.6974426384012203`*^9, 3.697442640480812*^9}, {3.697442861825642*^9, 
   3.697442894184705*^9}, {3.697443002035005*^9, 3.697443022330298*^9}, 
   3.69744326618968*^9, {3.6974508322291107`*^9, 3.6974508328939047`*^9}, {
   3.6974508718182583`*^9, 3.6974508890888853`*^9}, {3.6975277799985113`*^9, 
   3.6975277824099417`*^9}, {3.6975279472152557`*^9, 3.697527956709997*^9}, {
   3.697528149573495*^9, 3.697528152180903*^9}, {3.6975282467191973`*^9, 
   3.697528249134767*^9}, {3.697528291771585*^9, 3.697528313446024*^9}, {
   3.697528688189831*^9, 3.697528691487753*^9}, {3.697528738336568*^9, 
   3.697528740419119*^9}, {3.6975288930338507`*^9, 3.697528903010861*^9}, 
   3.697528946828561*^9, {3.697531668109559*^9, 3.6975316705583897`*^9}, {
   3.697531704316194*^9, 3.6975317183371964`*^9}, {3.697615609180044*^9, 
   3.697615611182434*^9}, {3.697655894007701*^9, 3.697655896487063*^9}, {
   3.697655969478466*^9, 3.6976559796513567`*^9}, {3.6976560195319433`*^9, 
   3.697656022963387*^9}, {3.697656063730227*^9, 3.697656063881587*^9}, 
   3.697656126332077*^9, {3.697664511097324*^9, 3.697664513250901*^9}, {
   3.698075762935545*^9, 3.698075783621708*^9}, {3.6984044106025333`*^9, 
   3.69840441263056*^9}, {3.7014968469328737`*^9, 3.701496854577729*^9}, {
   3.7014969656200867`*^9, 3.701496968194414*^9}, 3.70814693700329*^9, 
   3.708146982381838*^9, {3.7081470837493057`*^9, 3.7081471359716063`*^9}, 
   3.712756390638192*^9, {3.71275643872965*^9, 3.712756458100329*^9}, {
   3.7185351076023912`*^9, 3.7185351155985003`*^9}, {3.718535245984332*^9, 
   3.7185352579792833`*^9}, {3.718535389704257*^9, 3.71853540547337*^9}, {
   3.7189541722424173`*^9, 3.718954183992049*^9}, {3.7189543122630672`*^9, 
   3.718954317113212*^9}, {3.718960164075938*^9, 3.7189602133983917`*^9}, {
   3.725010625652071*^9, 3.7250106284984922`*^9}, {3.725010808139*^9, 
   3.725010813119035*^9}, 3.725263288618083*^9, {3.725263592033388*^9, 
   3.725263605365827*^9}, {3.72526378656503*^9, 3.725263790340252*^9}, {
   3.725275700964411*^9, 3.725275706131958*^9}, {3.725275950467389*^9, 
   3.7252759538669243`*^9}, {3.725276128547813*^9, 3.725276170623996*^9}, {
   3.725276346225898*^9, 3.725276362084021*^9}, {3.725432064149164*^9, 
   3.725432076466485*^9}, {3.725432208074644*^9, 3.725432216985297*^9}, 
   3.7254326117605143`*^9, 3.725432763237898*^9, 3.725433345761812*^9, {
   3.725433697231565*^9, 3.7254337251209583`*^9}, {3.725434203911171*^9, 
   3.7254342304769382`*^9}, {3.7254344713996058`*^9, 3.725434483723885*^9}, {
   3.725434748736558*^9, 3.725434751916737*^9}, {3.725435006550578*^9, 
   3.725435017562211*^9}, {3.7254351026885557`*^9, 3.725435109765566*^9}, {
   3.7254360790514193`*^9, 3.725436089848844*^9}, {3.729247911061453*^9, 
   3.729247913912911*^9}, {3.731672868999936*^9, 3.7316729195211363`*^9}, {
   3.731672978896916*^9, 3.731672979356606*^9}, {3.7316730363289557`*^9, 
   3.731673046193924*^9}, {3.731673329999075*^9, 3.731673336044633*^9}, {
   3.7316735121454372`*^9, 3.731673512315729*^9}, {3.7316735474703913`*^9, 
   3.73167357480709*^9}, {3.731673669170731*^9, 3.7316736899056053`*^9}, 
   3.732160304372958*^9, {3.7321604609584837`*^9, 3.732160461897937*^9}, {
   3.732160532317053*^9, 3.732160589677483*^9}, {3.732160662138524*^9, 
   3.732160851839506*^9}, {3.732160962400895*^9, 3.7321609926499577`*^9}, {
   3.732161053311274*^9, 3.7321612421695147`*^9}, {3.732161431169909*^9, 
   3.732161483960725*^9}, {3.732161530760303*^9, 3.7321615424302692`*^9}, {
   3.7321615976580057`*^9, 3.7321617139732018`*^9}, {3.732161746645199*^9, 
   3.7321618532206717`*^9}, {3.73216191287094*^9, 3.732161952287737*^9}, {
   3.732161988290028*^9, 3.732162101911686*^9}, {3.732162159731244*^9, 
   3.732162188245363*^9}, {3.732162758625677*^9, 3.732162798580942*^9}, {
   3.7321628362548723`*^9, 3.7321628899386663`*^9}, 3.7321629689924917`*^9, {
   3.7321630171430492`*^9, 3.7321630227251*^9}, {3.7321630640195417`*^9, 
   3.7321631995324907`*^9}, {3.732163234052513*^9, 3.732163242892695*^9}, {
   3.732163277739743*^9, 3.732163360870411*^9}, {3.7321640472236347`*^9, 
   3.732164051718059*^9}, {3.732164135908338*^9, 3.732164158290659*^9}, {
   3.732164595893446*^9, 3.732164596165946*^9}, {3.732164835562994*^9, 
   3.7321648924147882`*^9}, {3.732168434466711*^9, 3.732168437339726*^9}, {
   3.7321684679608717`*^9, 3.7321684780381327`*^9}, {3.7321685273809137`*^9, 
   3.732168528770204*^9}, {3.732168642227126*^9, 3.732168645331231*^9}, {
   3.73216869624044*^9, 3.7321687195301037`*^9}, {3.732168911706202*^9, 
   3.732168927489253*^9}, {3.732169048986747*^9, 3.732169114138693*^9}, {
   3.732169160255577*^9, 3.7321691839207983`*^9}, {3.7321692898814077`*^9, 
   3.732169332256021*^9}, {3.732169496747197*^9, 3.732169502203368*^9}, {
   3.732175545459379*^9, 3.732175551027763*^9}, {3.734179096600849*^9, 
   3.734179096814662*^9}, {3.8282470958601093`*^9, 3.828247102241515*^9}, {
   3.82824715808762*^9, 3.828247174920445*^9}, {3.829815299913704*^9, 
   3.829815307411749*^9}, {3.829815436100152*^9, 3.8298154447339373`*^9}, {
   3.830733000507234*^9, 3.830733067030281*^9}, {3.8307331234050083`*^9, 
   3.830733125225381*^9}, {3.830733198281485*^9, 3.830733223965136*^9}, 
   3.830733286164896*^9, 3.8307333596689157`*^9, 3.830733403872992*^9, {
   3.8307334911232*^9, 3.8307335205525017`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"21f4052e-2035-483c-b23a-2bcdd2d3ae03"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bosonic heat kernel", "Subsection",
 CellChangeTimes->{{3.696836833735641*^9, 
  3.696836851446714*^9}},ExpressionUUID->"7dafe2a0-39fa-42f5-9be9-\
a5ec2a194d97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dagger", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ComplexExpand", "[", 
           RowBox[{"Conjugate", "[", "in", "]"}], "]"}], "/.", 
          "HermitianRules"}], "//", "Simp"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trans", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Res", ",", "n", ",", "spin", ",", "Trans", ",", "i", ",", "j"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", " ", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"in", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Trans", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", " ", "1"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[GreaterEqual]", " ", "1"}], 
             "&&", 
             RowBox[{"spin", ">", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Trans", "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{
                    RowBox[{"base", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"base", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", 
                    RowBox[{"base", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"base", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{
                    RowBox[{"base", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"base", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], ",", "spin"}],
                    "}"}]}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Res", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{
              RowBox[{"in", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", "Trans"}], "]"}], 
            "//", "dagger"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tab", "[", "In_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Res", ",", "spin", ",", "Trans"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "In", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"In", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"spin", ">", " ", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Trans", "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", " ", 
                    RowBox[{"spin", "-", "2"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"spin", ",", 
                  RowBox[{"spin", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Res", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"t", "[", 
               RowBox[{
                RowBox[{"In", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "Trans"}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Prodom", "[", 
     RowBox[{"om_", ",", "base_", ",", "cont_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "omas", ",", "Res", ",", "i", ",", "j", ",", "k", ",", 
        "first", ",", "sec", ",", "Trans", ",", "product", ",", "rank"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "om", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"omas", "=", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"om", "-", 
           RowBox[{"trans", "[", 
            RowBox[{"om", ",", "base"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"first", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"omas", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sec", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"omas", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"If", " ", "nonzero"}], ",", " ", 
            RowBox[{
            "the", " ", "matrix", " ", "element", " ", "has", " ", "at", " ", 
             "least", " ", "the", " ", "index", " ", "\[Alpha]"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"first", ">", " ", "0"}], " ", "&&", " ", 
             RowBox[{"sec", ">", " ", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Trans", "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", " ", 
                    RowBox[{"first", "-", "1"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"first", "+", "sec", "-", "1"}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"first", "+", "m", "-", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"sec", "-", "1"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"first", "+", "sec"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"product", "=", 
              RowBox[{"t", "[", 
               RowBox[{
                RowBox[{"tp", "[", 
                 RowBox[{
                  RowBox[{"omas", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"omas", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
                "Trans"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"product", "=", 
                RowBox[{"Contract", "[", 
                 RowBox[{"product", ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"first", "-", "1"}], ",", "first"}], "}"}], 
                   "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "\[Equal]", " ", "2"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"product", "=", 
                 RowBox[{"multiDot", "[", 
                  RowBox[{"product", ",", "GUUUU", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"first", "-", "2"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"first", "-", "1"}], ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"first", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"first", "+", "1"}], ",", "4"}], "}"}]}], "}"}]}],
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"cont", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"rank", "=", 
                 RowBox[{"Spin", "[", "product", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"product", "=", 
                 RowBox[{"Contract", "[", 
                  RowBox[{"product", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rank", "-", "1"}], ",", "rank"}], "}"}], "}"}]}],
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Res", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", "product"}], 
             ";"}], ","}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dom", "[", 
     RowBox[{"om_", ",", "base_", ",", "cont_", ",", "sym_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Res", ",", "oms", ",", "spin", ",", "Trans"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "om", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sym", "\[Equal]", "\"\<Anti\>\""}], ",", 
         RowBox[{"oms", "=", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"om", "-", 
             RowBox[{"trans", "[", 
              RowBox[{"om", ",", "base"}], "]"}]}], ")"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sym", "\[Equal]", "\"\<E\>\""}], ",", 
         RowBox[{"oms", "=", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"om", "+", 
             RowBox[{"trans", "[", 
              RowBox[{"om", ",", "base"}], "]"}]}], ")"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"oms", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"spin", ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"cont", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Res", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"Contract", "[", 
                RowBox[{
                 RowBox[{"covD", "[", 
                  RowBox[{"oms", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin", ",", 
                    RowBox[{"spin", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Trans", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", 
                    RowBox[{"spin", "-", "1"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"spin", "+", "1"}], ",", "spin"}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Res", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                RowBox[{"t", "[", 
                 RowBox[{
                  RowBox[{"covD", "[", 
                   RowBox[{"oms", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
                  "Trans"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
            "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComputeE", "[", 
     RowBox[{"P_", ",", "base_", ",", "om_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Omsq", ",", "Domp", ",", "Spins"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Omsq", "=", 
        RowBox[{"Prodom", "[", 
         RowBox[{"om", ",", "base", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Domp", "=", 
        RowBox[{"Dom", "[", 
         RowBox[{"om", ",", "base", ",", "True", ",", "\"\<E\>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"P", "+", 
             RowBox[{"trans", "[", 
              RowBox[{"P", ",", "base"}], "]"}]}], ")"}]}], "-", " ", "Omsq", 
          "-", " ", "Domp"}], "//", "Simp"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ComputeOm", "[", 
     RowBox[{"om_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "base", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", " ", 
        RowBox[{
         RowBox[{"Prodom", "[", 
          RowBox[{"om", ",", "base", ",", "False"}], "]"}], "+", 
         RowBox[{"Dom", "[", 
          RowBox[{"om", ",", "base", ",", "False", ",", "\"\<Anti\>\""}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"Res", "-", 
         RowBox[{"tab", "[", "Res", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{"Res", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
             RowBox[{"2", " ", 
              RowBox[{"t", "[", 
               RowBox[{
                RowBox[{"tp", "[", 
                 RowBox[{
                  RowBox[{"RiemannCD", "[", 
                   RowBox[{
                    RowBox[{"-", "a"}], ",", 
                    RowBox[{"-", "b"}], ",", 
                    RowBox[{"-", "c"}], ",", 
                    RowBox[{"-", "d"}]}], "]"}], ",", 
                  RowBox[{"gmn", "[", 
                   RowBox[{
                    RowBox[{"-", "a"}], ",", 
                    RowBox[{"-", "b"}]}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "4"}], 
                 "}"}]}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Res", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
             RowBox[{"RiemannCD", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "b"}], ",", 
               RowBox[{"-", "c"}], ",", 
               RowBox[{"-", "d"}]}], "]"}]}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TrG", "[", "in_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"in", ",", "GUUUU", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Trg", "[", "in_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"in", ",", 
         RowBox[{"gmn", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqGG", "[", "in_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "int", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "in", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"int", "=", 
       RowBox[{"multiDot", "[", 
        RowBox[{"GUUUU", ",", "in", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"int", ",", "int", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "2"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqGg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Inter", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "in", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Inter", "=", 
       RowBox[{"multiDot", "[", 
        RowBox[{"in", ",", "bin", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"3", ",", "1"}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"Inter", ",", "GUUUU", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sqgg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "in", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"in", ",", "bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "]"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqG", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Inter", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "in", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Inter", "=", 
       RowBox[{"tp", "[", 
        RowBox[{"in", ",", "bin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"Inter", ",", "GUUUU", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sqg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "in", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"in", ",", "bin", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sq", "[", 
     RowBox[{"In_", ",", "Bin_", ",", "lspin_", ",", "rspin_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"tp", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Sqg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Sqg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Sqgg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqG", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqG", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqGg", "[", 
           RowBox[{"Bin", ",", "In"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqGg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqGG", "[", "In", "]"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TrE", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "n", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
         RowBox[{"i", "+=", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Res", "+=", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "1", ",", 
             RowBox[{"Trg", "[", 
              RowBox[{"in", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], "]"}], ",", "2", ",", 
             RowBox[{"TrG", "[", 
              RowBox[{"in", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rTrSq", "[", 
     RowBox[{"in_", ",", "base_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "=", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", "=", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "3"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Res", "+=", " ", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"Sq", "[", 
             RowBox[{
              RowBox[{"in", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"in", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"base", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"base", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TrSq", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "n", ",", "val"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"val", "=", 
           RowBox[{"Sq", "[", 
            RowBox[{
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Res", "+=", "val"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqOGG", "[", "In_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Inter", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "In", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Inter", "=", 
       RowBox[{"multiDot", "[", 
        RowBox[{"GUUUU", ",", "In", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"Inter", ",", "Inter", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "6"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqOGg", "[", 
    RowBox[{"In_", ",", "Bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Inter", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "In", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Inter", "=", 
       RowBox[{"multiDot", "[", 
        RowBox[{"In", ",", "Bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "5"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"Inter", ",", "GUUUU", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqOgg", "[", 
    RowBox[{"In_", ",", "Bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "In", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"In", ",", "Bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqOG", "[", 
    RowBox[{"In_", ",", "Bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Inter", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "In", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Inter", "=", 
       RowBox[{"multiDot", "[", 
        RowBox[{"In", ",", "Bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"Inter", ",", "GUUUU", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqOg", "[", 
    RowBox[{"In_", ",", "Bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "In", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"In", ",", "Bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SqO", "[", 
    RowBox[{"In_", ",", "Bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Spin", "[", "In", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"multiDot", "[", 
        RowBox[{"In", ",", "Bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SqOm", "[", 
     RowBox[{"In_", ",", "Bin_", ",", "lspin_", ",", "rspin_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqO", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], " ", "||", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqOg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqOgg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}]}], " ", "||", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0"}], "}"}]}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqOG", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], " ", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqOGg", "[", 
           RowBox[{"Bin", ",", "In"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}]}], " ", ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqOGg", "[", 
           RowBox[{"In", ",", "Bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"SqOGG", "[", "In", "]"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TrSqO", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "val", ",", "n", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"val", "=", 
           RowBox[{"SqOm", "[", 
            RowBox[{
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Res", "+=", "val"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Res", "//", "Simp"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rTrSqO", "[", 
    RowBox[{"in_", ",", "base_", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Res", ",", "times", ",", "i", ",", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"times", "=", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "=", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"j", "=", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Res", "+=", " ", 
          RowBox[{"times", " ", 
           RowBox[{"SqOm", "[", 
            RowBox[{
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Res", "//", "Simp"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696416403440029*^9, 3.696416405765904*^9}, 
   3.69641659064622*^9, {3.696419034986025*^9, 3.696419084924019*^9}, {
   3.696419185805396*^9, 3.696419243400618*^9}, {3.6964193985367813`*^9, 
   3.6964194013103113`*^9}, {3.696419691135957*^9, 3.69641972392428*^9}, {
   3.6964197805712357`*^9, 3.696419836480789*^9}, {3.696419921526278*^9, 
   3.696419921686829*^9}, {3.696420301245668*^9, 3.69642030346836*^9}, {
   3.696420526199566*^9, 3.696420546759686*^9}, {3.696420579292745*^9, 
   3.696420580891368*^9}, {3.6964207240141983`*^9, 3.6964207336297207`*^9}, {
   3.69642098018573*^9, 3.696421103021076*^9}, {3.6964211841009817`*^9, 
   3.6964212426742764`*^9}, {3.696422091480564*^9, 3.696422104803281*^9}, 
   3.696422215041101*^9, {3.696422645084652*^9, 3.696422655328703*^9}, {
   3.6964229223385963`*^9, 3.696423112734942*^9}, {3.6964231453112926`*^9, 
   3.696423145346601*^9}, {3.696423175487145*^9, 3.696423191818503*^9}, {
   3.696423274700719*^9, 3.696423348373066*^9}, {3.6964234122674417`*^9, 
   3.6964234561100903`*^9}, {3.6964234956814632`*^9, 3.696423538178076*^9}, 
   3.696423568330612*^9, {3.6964236396971617`*^9, 3.696423662540861*^9}, {
   3.696423731854699*^9, 3.696423740086804*^9}, {3.69642452259256*^9, 
   3.6964245226377563`*^9}, {3.696445139146413*^9, 3.696445282550168*^9}, {
   3.6964453202194567`*^9, 3.696445358633366*^9}, 3.696445895689065*^9, {
   3.6964465733859863`*^9, 3.696446575759633*^9}, {3.696448260894762*^9, 
   3.696448261323887*^9}, {3.6964797797201147`*^9, 3.696479828956757*^9}, {
   3.6964798865203133`*^9, 3.696479892874758*^9}, {3.696480604775016*^9, 
   3.696480679109971*^9}, {3.69648073321953*^9, 3.696480740113353*^9}, {
   3.696480821612712*^9, 3.696480855311048*^9}, {3.696480891988615*^9, 
   3.696480963958168*^9}, {3.696481486801762*^9, 3.696481494780794*^9}, {
   3.696534055484271*^9, 3.696534058935069*^9}, {3.696538901451294*^9, 
   3.6965389209775963`*^9}, {3.696579721550947*^9, 3.6965797245964212`*^9}, {
   3.696579770783083*^9, 3.696579772340249*^9}, {3.696594482334572*^9, 
   3.696594509547871*^9}, {3.6965946509092503`*^9, 3.6965947780328617`*^9}, {
   3.696597701381778*^9, 3.6965977251297293`*^9}, {3.6966165637739763`*^9, 
   3.696616565099959*^9}, {3.696618441447116*^9, 3.696618444190756*^9}, {
   3.696618605532721*^9, 3.696618605666953*^9}, {3.696656673055469*^9, 
   3.696656686162375*^9}, {3.696676627043767*^9, 3.696676632088546*^9}, {
   3.696676708889647*^9, 3.69667671190177*^9}, {3.6966795446906652`*^9, 
   3.69667956027248*^9}, {3.6966807538404617`*^9, 3.6966807606782103`*^9}, {
   3.696680935067086*^9, 3.696680941776431*^9}, {3.6966810584464827`*^9, 
   3.696681063467814*^9}, {3.696681137654028*^9, 3.6966811404359827`*^9}, {
   3.696681224908278*^9, 3.6966812272993593`*^9}, {3.696688444854224*^9, 
   3.696688448506154*^9}, {3.696690761099*^9, 3.69669079995161*^9}, {
   3.696693121179553*^9, 3.696693184206382*^9}, {3.696693276954433*^9, 
   3.6966932934922943`*^9}, {3.6966936008308907`*^9, 
   3.6966936009888372`*^9}, {3.6967051464018917`*^9, 3.696705172299811*^9}, {
   3.6968367817052927`*^9, 3.696836782758429*^9}, {3.696915082693452*^9, 
   3.696915096652924*^9}, {3.696920941648754*^9, 3.696920942003559*^9}, {
   3.696930139231864*^9, 3.6969301507055473`*^9}, {3.6969303685599337`*^9, 
   3.696930388193296*^9}, {3.696930638175385*^9, 3.696930657570786*^9}, {
   3.69693685283327*^9, 3.696936985132843*^9}, {3.6969370184090767`*^9, 
   3.696937104200842*^9}, {3.6969371345159693`*^9, 3.6969371823570147`*^9}, {
   3.696938229164488*^9, 3.696938231041525*^9}, 3.696938288597272*^9, {
   3.696938459459723*^9, 3.696938489463925*^9}, {3.696939143140307*^9, 
   3.6969391464173727`*^9}, {3.696939181184332*^9, 3.696939193371943*^9}, {
   3.696939245569804*^9, 3.696939256858346*^9}, {3.6969393148545017`*^9, 
   3.6969393149360332`*^9}, {3.696939388012946*^9, 3.6969393953983707`*^9}, {
   3.696947842616802*^9, 3.696947844893725*^9}, {3.696948233196109*^9, 
   3.696948242762575*^9}, {3.6969483003669567`*^9, 3.696948300642754*^9}, {
   3.696949193634951*^9, 3.6969492085430717`*^9}, {3.696949391339797*^9, 
   3.6969493932797813`*^9}, {3.696949445916932*^9, 3.6969494981915207`*^9}, {
   3.696950677105959*^9, 3.696950679175128*^9}, {3.6969515337702427`*^9, 
   3.696951533825334*^9}, {3.69695200665692*^9, 3.69695202102204*^9}, {
   3.6969520677660933`*^9, 3.69695211224343*^9}, 3.696952175674712*^9, {
   3.69695221054478*^9, 3.696952219859074*^9}, {3.696952574434998*^9, 
   3.696952613101735*^9}, {3.696952761202503*^9, 3.696952774202114*^9}, {
   3.696953522656793*^9, 3.696953534526807*^9}, {3.6969537208768044`*^9, 
   3.69695382743723*^9}, {3.696954542368977*^9, 3.696954542778727*^9}, {
   3.696954634366106*^9, 3.696954634792183*^9}, {3.696954786751707*^9, 
   3.6969548113958197`*^9}, {3.69695484533609*^9, 3.696954856881054*^9}, {
   3.696954887166294*^9, 3.6969549669382343`*^9}, 3.696955015218586*^9, {
   3.696956553579715*^9, 3.6969565585456047`*^9}, {3.6969568074639587`*^9, 
   3.696956838379652*^9}, {3.696959343161108*^9, 3.6969593454751663`*^9}, {
   3.6969597527344303`*^9, 3.696959753356844*^9}, {3.696963879610416*^9, 
   3.6969639412760468`*^9}, {3.696964051695363*^9, 3.69696407706688*^9}, {
   3.696964107116467*^9, 3.6969641169192457`*^9}, {3.696964285002396*^9, 
   3.696964290038168*^9}, {3.6969644492602053`*^9, 3.696964454934656*^9}, {
   3.69696449738531*^9, 3.696964518157761*^9}, {3.6969645874878798`*^9, 
   3.696964614262196*^9}, {3.6969646511420116`*^9, 3.696964660975589*^9}, {
   3.69696472977635*^9, 3.696964803522345*^9}, {3.696964880638534*^9, 
   3.696964987922617*^9}, {3.6969651086954517`*^9, 3.696965119373064*^9}, {
   3.696965180269384*^9, 3.6969652255227003`*^9}, {3.696965261558742*^9, 
   3.696965280738257*^9}, {3.696966132489561*^9, 3.6969661424992237`*^9}, {
   3.6969661976988773`*^9, 3.696966211601109*^9}, {3.696968622135116*^9, 
   3.69696868318692*^9}, {3.696968723237269*^9, 3.6969687407851353`*^9}, {
   3.696968902553512*^9, 3.696968926909391*^9}, {3.696970780003497*^9, 
   3.696970780278923*^9}, {3.696971215105644*^9, 3.696971215667488*^9}, {
   3.6969712791195173`*^9, 3.696971279177285*^9}, {3.697003171790259*^9, 
   3.697003185453245*^9}, {3.697018340999756*^9, 3.697018346969058*^9}, {
   3.697018473405582*^9, 3.6970184757134027`*^9}, 3.697019225880149*^9, {
   3.697019256527145*^9, 3.697019256845147*^9}, {3.697019419224506*^9, 
   3.697019420655809*^9}, 3.697019506025998*^9, 3.697019559066148*^9, {
   3.697019628047163*^9, 3.697019644317492*^9}, 3.697032612327777*^9, 
   3.697043637106835*^9, {3.69708517441518*^9, 3.697085202840365*^9}, {
   3.697085312501327*^9, 3.697085312754464*^9}, 3.697106060520029*^9, {
   3.697106094779142*^9, 3.697106103761829*^9}, {3.6971753853756647`*^9, 
   3.697175387146635*^9}, {3.697175456199246*^9, 3.697175531139638*^9}, {
   3.697175562915674*^9, 3.697175575609858*^9}, {3.6971756057714033`*^9, 
   3.697175607543838*^9}, {3.697175640762261*^9, 3.697175653063938*^9}, {
   3.697175718887236*^9, 3.697175737126245*^9}, 3.6973512392896442`*^9, 
   3.697650313830675*^9, {3.69765307229314*^9, 3.697653079043343*^9}, {
   3.697653110917016*^9, 3.697653177160563*^9}, {3.697653554681457*^9, 
   3.6976535731404343`*^9}, {3.6976536122776403`*^9, 3.697653621725554*^9}, {
   3.697654072152281*^9, 3.697654073439213*^9}, {3.697654225229206*^9, 
   3.6976542255966787`*^9}, {3.697654272366806*^9, 3.697654272435175*^9}, {
   3.6976543617969303`*^9, 3.697654361944064*^9}, {3.6976544529225903`*^9, 
   3.697654453269392*^9}, 3.697654545092606*^9, {3.697655080479857*^9, 
   3.697655098026037*^9}, {3.697655129141511*^9, 3.697655158632896*^9}, {
   3.697655237772459*^9, 3.6976552379389143`*^9}, {3.6976555093147697`*^9, 
   3.69765550946519*^9}, {3.697655559285534*^9, 3.697655570032193*^9}, {
   3.697655601841063*^9, 3.6976556295653553`*^9}, {3.6976556651777687`*^9, 
   3.6976556673006144`*^9}, {3.697655732414604*^9, 3.697655738952721*^9}, {
   3.697655772371697*^9, 3.697655774350769*^9}, {3.697655811840719*^9, 
   3.6976558320262814`*^9}, {3.697656536654567*^9, 3.6976565371317253`*^9}, 
   3.6976567935562277`*^9, {3.697657334822997*^9, 3.697657343350422*^9}, {
   3.6976574163955812`*^9, 3.6976574494501677`*^9}, {3.697657635108878*^9, 
   3.6976576368364153`*^9}, {3.697658736855357*^9, 3.697658848481297*^9}, {
   3.697658884621594*^9, 3.697658946630867*^9}, 3.697659067541692*^9, {
   3.697659139801797*^9, 3.6976591832072906`*^9}, {3.697659225735127*^9, 
   3.697659379488965*^9}, {3.6976594319400043`*^9, 3.6976594807588577`*^9}, {
   3.697659512606238*^9, 3.69765951839182*^9}, {3.697659637638818*^9, 
   3.69765964005879*^9}, {3.6976645761082067`*^9, 3.69766458042559*^9}, 
   3.697665333021907*^9, {3.697665383800461*^9, 3.697665415121718*^9}, {
   3.6976654631548243`*^9, 3.697665465206327*^9}, {3.6984774686951923`*^9, 
   3.698477583771769*^9}, {3.7091922223287277`*^9, 3.709192226654666*^9}, {
   3.732122338123611*^9, 3.732122363649433*^9}, {3.732123625660144*^9, 
   3.7321236360473137`*^9}, {3.7321255281362886`*^9, 3.7321255299588327`*^9}, 
   3.732126655334758*^9, {3.732127307918989*^9, 3.732127313711762*^9}, {
   3.7321273636319323`*^9, 3.732127363878545*^9}, {3.732130359780278*^9, 
   3.7321303601740026`*^9}, {3.7321341208586187`*^9, 3.732134138566*^9}, {
   3.7321343092447033`*^9, 3.732134314658724*^9}, {3.732158135903651*^9, 
   3.732158257352684*^9}, {3.732158432620037*^9, 3.732158432976924*^9}, {
   3.7321588150065327`*^9, 3.732158820314172*^9}, {3.732158958887805*^9, 
   3.732159123293211*^9}, {3.732159192819734*^9, 3.732159193505795*^9}, {
   3.732159318697394*^9, 3.73215936231807*^9}, {3.7321594889372187`*^9, 
   3.73215950185426*^9}, {3.73418244878942*^9, 3.73418245326554*^9}, {
   3.734182706524713*^9, 3.73418270845016*^9}, {3.734183257829892*^9, 
   3.734183284554154*^9}, {3.7341840790477877`*^9, 3.73418408471178*^9}, {
   3.734184970112857*^9, 3.7341849803736687`*^9}, 3.734186525743926*^9, 
   3.734191418863431*^9, {3.7341924111904573`*^9, 3.734192430074875*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"38e2594a-7a7c-44d1-8655-fc5744a6fd53"]
}, Closed]],

Cell[CellGroupData[{

Cell["Spinor logic", "Subsection",
 CellChangeTimes->{{3.6968368943387747`*^9, 
  3.6968368983599777`*^9}},ExpressionUUID->"e4b4fd70-8892-4465-a7da-\
d181adbb32e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GammaDiff", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"CD", "[", 
          RowBox[{"-", "a"}], "]"}], "[", 
         RowBox[{"gamma", "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], "]"}], ",", 
        "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"CD", "[", 
          RowBox[{"-", "a"}], "]"}], "[", 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], "]"}], ",", 
        "0"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"CD", "[", 
          RowBox[{"-", "a"}], "]"}], "[", 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], "]"}], ",", 
        "0"}], "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaToEpsilon", "=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"c", ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"gmn", "[", 
           RowBox[{"a", ",", "b"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Delta]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"gmn", "[", 
           RowBox[{"b", ",", "c"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Delta]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"gmn", "[", 
           RowBox[{"a", ",", "c"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Delta]"}], "]"}]}], "+", 
         "      ", 
         RowBox[{
          RowBox[{"epsilongmn", "[", 
           RowBox[{"d", ",", "a", ",", "b", ",", "c"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "d"}], ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], " ", 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"LI", "[", "5", "]"}], ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Delta]"}], "]"}]}]}]}], "}"}], 
      ",", 
      RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "rule", " ", "should", " ", "only", " ", "be", " ", "used", 
    " ", "on", " ", "uncontracted", " ", "expression", " ", 
    RowBox[{"(", 
     RowBox[{
     "or", " ", "it", " ", "gives", " ", "an", " ", "infinite", " ", "loop"}],
      ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gamma5Commute", "=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}]}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaSimp", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"LI", "[", "6", "]"}], ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"LI", "[", "5", "]"}], ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"LI", "[", "5", "]"}], ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"gamma", "[", 
         RowBox[{"a", ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"gamma", "[", 
         RowBox[{"a", ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"gamma", "[", 
         RowBox[{
          RowBox[{"LI", "[", "6", "]"}], ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"4", 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Rho]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "\[Rho]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Rho]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"c", ",", 
           RowBox[{"-", "\[Rho]"}], ",", "\[Sigma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "\[Sigma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{"4", 
         RowBox[{"gmn", "[", 
          RowBox[{"b", ",", "c"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaTraces", "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"c", ",", 
             RowBox[{"-", "\[Gamma]"}], ",", "\[Rho]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"d", ",", 
             RowBox[{"-", "\[Rho]"}], ",", "\[Alpha]"}], "]"}]}], ",", 
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"gmn", "[", 
               RowBox[{"a", ",", "b"}], "]"}], 
              RowBox[{"gmn", "[", 
               RowBox[{"c", ",", "d"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"gmn", "[", 
               RowBox[{"a", ",", "c"}], "]"}], 
              RowBox[{"gmn", "[", 
               RowBox[{"b", ",", "d"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"gmn", "[", 
               RowBox[{"a", ",", "d"}], "]"}], 
              RowBox[{"gmn", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Gamma]"}], ",", "\[Sigma]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"c", ",", 
             RowBox[{"-", "\[Sigma]"}], ",", "\[Rho]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"d", ",", 
             RowBox[{"-", "\[Rho]"}], ",", "\[Sigma]1"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Sigma]1"}], ",", "\[Alpha]"}], "]"}]}], ",", 
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"gmn", "[", 
               RowBox[{"a", ",", "b"}], "]"}], 
              RowBox[{"gmn", "[", 
               RowBox[{"c", ",", "d"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"gmn", "[", 
               RowBox[{"a", ",", "c"}], "]"}], 
              RowBox[{"gmn", "[", 
               RowBox[{"b", ",", "d"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"gmn", "[", 
               RowBox[{"a", ",", "d"}], "]"}], 
              RowBox[{"gmn", "[", 
               RowBox[{"b", ",", "c"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"c", ",", 
             RowBox[{"-", "\[Gamma]"}], ",", "\[Rho]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"d", ",", 
             RowBox[{"-", "\[Rho]"}], ",", "\[Sigma]1"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Sigma]1"}], ",", "\[Alpha]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], " ", "4", "  ", 
           RowBox[{"epsilongmn", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "}"}], 
        ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Sigma]"}], ",", "\[Alpha]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Beta]"}], ",", "\[Rho]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Rho]"}], ",", "\[Gamma]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Gamma]"}], ",", "\[Sigma]"}], "]"}]}], ",", 
          "0"}], "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Gamma]"}], ",", "\[Alpha]"}], "]"}]}], ",", 
          "0"}], "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Beta]"}], ",", "\[Alpha]"}], "]"}]}], ",", 
          RowBox[{"4", " ", 
           RowBox[{"gmn", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Beta]"}], ",", "\[Rho]"}], "]"}], 
           RowBox[{"gamma", "[", 
            RowBox[{"b", ",", 
             RowBox[{"-", "\[Rho]"}], ",", "\[Delta]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Delta]"}], ",", "\[Alpha]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           RowBox[{"gmn", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
           RowBox[{"gamma5", "[", 
            RowBox[{
             RowBox[{"-", "\[Beta]"}], ",", "\[Alpha]"}], "]"}]}], ",", "0"}],
          "}"}], ",", 
        RowBox[{"MetricOn", "\[Rule]", "All"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gamma5", "[", 
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], ",", "\[Alpha]"}], "]"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Rho]"}], ",", "\[Alpha]"}], "]"}]}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Alpha]"}], "]"}]}], ",", "0"}],
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Alpha]"}], "]"}], ",", "0"}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Gamma]"}], ",", "\[Sigma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Sigma]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Rho]"}], ",", "\[Alpha]"}], "]"}]}], ",", "0"}], 
        "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaNCTraces", "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Delta]"}], "]"}]}], ",", 
         RowBox[{"4", 
          RowBox[{"delta", "[", 
           RowBox[{
            RowBox[{"-", "\[Alpha]"}], ",", "\[Delta]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}]}], ",", " ", 
         RowBox[{"delta", "[", 
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "4"}], 
          RowBox[{"delta", "[", 
           RowBox[{
            RowBox[{"-", "\[Alpha]"}], ",", "\[Rho]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Rho]"}], ",", "\[Alpha]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Delta]"}], ",", "\[Alpha]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Rho]"}], ",", "\[Alpha]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          RowBox[{"delta", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Alpha]"}], "]"}]}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Beta]"}], ",", "\[Rho]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma5", "[", 
           RowBox[{
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Rho]"}], ",", "\[Alpha]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"gamma", "[", 
            RowBox[{"a", ",", 
             RowBox[{"-", "\[Beta]"}], ",", "\[Gamma]"}], "]"}]}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Alpha]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "\[Delta]"}], ",", "\[Beta]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "\[Rho]"}], ",", "\[Beta]"}], "]"}]}], ",", 
         RowBox[{"4", 
          RowBox[{"gmn", "[", 
           RowBox[{"b", ",", "c"}], "]"}], 
          RowBox[{"delta", "[", 
           RowBox[{
            RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"gamma", "[", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Gamma]"}], ",", "\[Delta]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Delta]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"d", ",", 
            RowBox[{"-", "\[Rho]"}], ",", "\[Sigma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "\[Sigma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "2"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"d", ",", 
            RowBox[{"-", "\[Alpha]"}], ",", "\[Rho]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"c", ",", 
            RowBox[{"-", "\[Rho]"}], ",", "\[Sigma]"}], "]"}], 
          RowBox[{"gamma", "[", 
           RowBox[{"b", ",", 
            RowBox[{"-", "\[Sigma]"}], ",", "\[Beta]"}], "]"}]}]}], "}"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CommuteGammaRule", "=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"gamma", "[", 
         RowBox[{"a", ",", 
          RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
        RowBox[{"gamma", "[", 
         RowBox[{"b", ",", 
          RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"gmn", "[", 
          RowBox[{"a", ",", "b"}], "]"}], 
         RowBox[{"delta", "[", 
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"b", ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Gamma]"}], "]"}], 
         RowBox[{"gamma", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", "\[Gamma]"}], ",", "\[Beta]"}], "]"}]}]}]}], "}"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaEval", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "5", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], ",", 
         RowBox[{"gamma5", "[", 
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], "]"}],
       ",", 
      RowBox[{"MakeRule", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{
           RowBox[{"LI", "[", "6", "]"}], ",", 
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}], ",", 
         RowBox[{"delta", "[", 
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Simp", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"ContractMetric", "[", "in", "]"}], "//", "Simplification"}],
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "gSimp", " ", "has", " ", "to", " ", "be", " ", "called", " ", "before", 
    " ", "fSimp"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gSimp", "[", 
    RowBox[{"in_", ",", 
     RowBox[{"contracted_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Simp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Expand", "[", "in", "]"}], "]"}], "/.", "GammaDiff"}], "//.", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"contracted", ",", 
              RowBox[{"{", "}"}], ",", "Gamma5Commute"}], "]"}], ",", 
            "GammaSimp", ",", "GammaToEpsilon"}], "]"}]}], "]"}], "//", 
        "SDI"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fSimp", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"Simp", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Expand", "[", 
             RowBox[{"in", "/.", "GammaEval"}], "]"}], "]"}], "//.", 
           RowBox[{"Join", "[", 
            RowBox[{"GammaTraces", ",", "GammaNCTraces"}], "]"}]}], "]"}], "//",
          "Expand"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sumSimp", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{"in", "//", "Expand"}], "//", "ToCanonical"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gSimp", "[", 
            RowBox[{
             RowBox[{"Res", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "True"}], "]"}], "//", 
           "fSimp"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "Res", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{
         RowBox[{"Res", "//", "Simp"}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "has", " ", "to", " ", "be", " ", "used", " ", "after", " ", 
    "fSimp"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"commuteGammaSimp", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"in", "/.", "CommuteGammaRule"}], "//", "gSimp"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"transOneGamma", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "spinind", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"spinind", "=", 
        RowBox[{"ListSpinorIndices", "[", "in", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", "in", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"spinind", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"spinind", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"spinind", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"spinind", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}], "]"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"transGamma", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Expand", "[", "in", "]"}], "]"}]}], ")"}], "/.", 
         RowBox[{"Plus", "\[Rule]", "List"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"transGammaMon", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", 
             RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], "//", 
         "SDI"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transGammaMon", "[", "in_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "indices", ",", "n", ",", "gammaPart", ",", "tensorPart", ",", "i", ",",
        "gammaArray", ",", "gammaRev", ",", "gammaIndices"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indices", "=", 
       RowBox[{"FindIndices", "[", 
        RowBox[{"Evaluate", "[", "in", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gammaArray", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gammaIndices", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "indices", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"SpinorIndexList", ",", 
             RowBox[{"indices", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"gammaArray", ",", 
              RowBox[{"gamma", "[", 
               RowBox[{
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"gammaIndices", ",", 
              RowBox[{"indices", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "+=", "3"}], ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", "+=", "1"}], ";"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "gammaArray", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "in", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gammaPart", "=", 
       RowBox[{"gammaArray", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"gammaPart", "=", 
         RowBox[{"gammaPart", " ", 
          RowBox[{"gammaArray", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tensorPart", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"in", ",", "gammaPart"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gammaRev", "=", 
       RowBox[{"transOneGamma", "[", 
        RowBox[{"gammaArray", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gammaRev", "=", 
          RowBox[{
           RowBox[{"transOneGamma", "[", 
            RowBox[{"gammaArray", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "gammaRev"}]}], 
         ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gammaRev", "=", 
       RowBox[{"ReplaceIndex", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "gammaRev", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Beta]"}], "\[Rule]", 
            RowBox[{"-", "\[Alpha]"}]}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "\[Beta]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"tensorPart", " ", "gammaRev"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6968369326467047`*^9, 3.696836939166624*^9}, {
   3.69683940007885*^9, 3.696839416583111*^9}, {3.696840155021412*^9, 
   3.696840159771743*^9}, {3.6968471943190937`*^9, 3.696847206991338*^9}, {
   3.69686623510916*^9, 3.696866239618347*^9}, {3.696873061208623*^9, 
   3.696873065847741*^9}, {3.696873467391329*^9, 3.6968734900184393`*^9}, {
   3.696875096560444*^9, 3.696875103196869*^9}, 3.696876949658031*^9, {
   3.696878296207036*^9, 3.696878305269895*^9}, {3.696910236311572*^9, 
   3.696910238843894*^9}, {3.696914925899844*^9, 3.6969149340115767`*^9}, 
   3.697096371696436*^9, {3.697096448365045*^9, 3.6970965771886587`*^9}, {
   3.697096709244969*^9, 3.697096715945353*^9}, {3.6970967727619143`*^9, 
   3.697096794789508*^9}, {3.697096842118215*^9, 3.697096850060008*^9}, {
   3.697097481545508*^9, 3.69709759583936*^9}, {3.6970976996689*^9, 
   3.697097728568111*^9}, {3.697097882763975*^9, 3.697097894384452*^9}, {
   3.69709792666862*^9, 3.697097963439622*^9}, {3.6970983249704533`*^9, 
   3.6970984322931223`*^9}, {3.697098671426893*^9, 3.697098678980494*^9}, {
   3.69709871047806*^9, 3.6970987423719807`*^9}, {3.697098815884137*^9, 
   3.697098916287446*^9}, {3.697099013229638*^9, 3.6970992237990503`*^9}, {
   3.697099508782921*^9, 3.6970995330368233`*^9}, {3.697099623905373*^9, 
   3.697099736885272*^9}, 3.6971169938241053`*^9, {3.697608435826619*^9, 
   3.69760845638489*^9}, {3.697608602631679*^9, 3.697608704492935*^9}, 
   3.697610939261074*^9, {3.697611043364332*^9, 3.6976110834492693`*^9}, {
   3.697611114270056*^9, 3.6976111223797617`*^9}, {3.6976111581575623`*^9, 
   3.697611161901902*^9}, 3.697611277442916*^9, {3.6976117266249113`*^9, 
   3.697611749335136*^9}, {3.697611823778266*^9, 3.697611841397585*^9}, {
   3.69761191643048*^9, 3.697611916770679*^9}, {3.6977861557875347`*^9, 
   3.6977863214331427`*^9}, {3.697786355674984*^9, 3.697786356455696*^9}, {
   3.6977884392787247`*^9, 3.697788439990117*^9}, {3.697788470789056*^9, 
   3.6977885506689796`*^9}, {3.69797561569494*^9, 3.697975616012587*^9}, {
   3.697975664798148*^9, 3.6979756943798857`*^9}, 3.6980415781977367`*^9, 
   3.716128311499325*^9, {3.7182070099016037`*^9, 3.718207021517151*^9}, 
   3.718207626392054*^9, {3.718207706880705*^9, 3.718207711017427*^9}, {
   3.718207758587764*^9, 3.718207774954707*^9}, {3.718785506170144*^9, 
   3.7187855071683807`*^9}, {3.718785753037088*^9, 3.718785777968587*^9}, {
   3.718785997948415*^9, 3.718785998930751*^9}, {3.720185079132176*^9, 
   3.720185099343704*^9}, {3.720185259025116*^9, 3.720185261557837*^9}, {
   3.720186356254174*^9, 3.7201863799061127`*^9}, {3.7201865148503532`*^9, 
   3.720186515471406*^9}, {3.7201866735141077`*^9, 3.720186691311689*^9}, {
   3.720186796080468*^9, 3.720186805147747*^9}, {3.720186994704246*^9, 
   3.7201869984940233`*^9}, {3.7249253125440197`*^9, 
   3.7249253174238377`*^9}, {3.724997304419978*^9, 3.724997363710651*^9}, {
   3.724998529485064*^9, 3.724998564674032*^9}, {3.724999010129593*^9, 
   3.724999019475603*^9}, {3.72500154591129*^9, 3.7250015475846367`*^9}, {
   3.732109647703291*^9, 3.7321096481906357`*^9}, {3.73210974006742*^9, 
   3.732109742542425*^9}, {3.8307652182232924`*^9, 3.8307652192617397`*^9}, {
   3.8307664935302143`*^9, 3.830766494657701*^9}, {3.830766850725979*^9, 
   3.8307668508714113`*^9}, {3.830813869258136*^9, 3.830813869424061*^9}, {
   3.830814760633502*^9, 3.830814799629122*^9}, {3.830814879819378*^9, 
   3.83081490690063*^9}, {3.838768879300103*^9, 3.838768884503757*^9}, {
   3.8387706014096193`*^9, 3.838770608684245*^9}, {3.839477080878235*^9, 
   3.839477084955016*^9}, {3.8409253368233624`*^9, 3.8409253441188393`*^9}, {
   3.8409257109159822`*^9, 3.840925713481352*^9}, {3.84092625475581*^9, 
   3.84092625740984*^9}, {3.841268270769349*^9, 3.841268274473241*^9}, {
   3.8471654243437653`*^9, 3.847165488560809*^9}, {3.847166014801751*^9, 
   3.847166044681692*^9}, {3.847166136017829*^9, 3.847166144734438*^9}, 
   3.847863718641944*^9, {3.8478697948934383`*^9, 3.8478698577775793`*^9}, {
   3.847869896143572*^9, 3.847869910781085*^9}, {3.847870443906251*^9, 
   3.847870445000424*^9}, {3.8478708509242563`*^9, 3.847870881796575*^9}, {
   3.848883280599015*^9, 3.848883281361215*^9}, {3.848885454329851*^9, 
   3.848885454453476*^9}},ExpressionUUID->"325d4bed-8314-463d-bd41-\
15d84d4a760b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Fermionic heat kernel", "Subsection",
 CellChangeTimes->{{3.696836861158908*^9, 
  3.696836867416498*^9}},ExpressionUUID->"6d393f68-f774-48d5-8921-\
99c14dbc20c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ReFC", "[", "in_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "conj", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"conj", "=", 
       RowBox[{"ComplexExpand", "[", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"in", "/.", "LorentzHermitianRules"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{"in", "+", "conj"}], ")"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"iImFC", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "conj", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"conj", "=", 
        RowBox[{"ComplexExpand", "[", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"in", "/.", "LorentzHermitianRules"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"in", "-", "conj"}], ")"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fdagger", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"ComplexExpand", "[", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"in", "/.", "HermitianRules"}], "]"}], "]"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ftrans", "[", 
     RowBox[{"In_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "n", ",", "spin"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "In", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", " ", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"In", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], "||", 
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "0"}]}], ")"}], "&&", 
             RowBox[{"spin", "\[GreaterEqual]", " ", "0"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Res", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"transGamma", "[", 
               RowBox[{"In", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", " ", "1"}], "&&", 
             " ", 
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", " ", "1"}], "&&", 
             RowBox[{"spin", ">", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Res", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"transGamma", "[", 
               RowBox[{"t", "[", 
                RowBox[{
                 RowBox[{"In", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"Res", "//", "fdagger"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ftab", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "Res", ",", "i", ",", "j", ",", "spin", ",", "Trans"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"in", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"spin", ">", " ", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Trans", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"m", ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", " ", 
                  RowBox[{"spin", "-", "2"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Trans", ",", "spin"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Trans", ",", 
               RowBox[{"spin", "-", "1"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Res", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"t", "[", 
               RowBox[{
                RowBox[{"in", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "Trans"}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fProdL", "[", 
     RowBox[{"L_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Lt", ",", "n", ",", "Res", ",", "first", ",", "sec", ",", "product", 
        ",", "projelem"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "L", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{"ftrans", "[", 
         RowBox[{"L", ",", "base"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"first", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"Lt", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sec", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"L", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"product", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"base", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "\[Equal]", " ", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"product", "=", 
             RowBox[{"tp", "[", 
              RowBox[{
               RowBox[{"Lt", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
               RowBox[{"L", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "j"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"base", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "\[Equal]", " ", "1"}], "&&", 
             " ", 
             RowBox[{"first", ">", "0"}], "&&", 
             RowBox[{"sec", ">", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"product", "=", 
              RowBox[{"tp", "[", 
               RowBox[{
                RowBox[{"Lt", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                RowBox[{"L", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "j"}], "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"product", "=", 
              RowBox[{"Contract", "[", 
               RowBox[{"product", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"first", ",", 
                   RowBox[{"first", "+", "1"}]}], "}"}], "}"}]}], "]"}]}]}]}],
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Res", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", "product"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fDL", "[", 
     RowBox[{"L_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Res", ",", "spin", ",", "Trans"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "L", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"L", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"spin", ">", 
             RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Res", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"multiDot", "[", 
              RowBox[{"gammaU", ",", 
               RowBox[{"covD", "[", 
                RowBox[{"L", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"spin", "+", "1"}]}], "}"}], "}"}]}], "]"}]}]}], 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fComputeP", "[", 
     RowBox[{"L_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "L", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"fProdL", "[", 
           RowBox[{"L", ",", "base"}], "]"}]}], "+", 
         RowBox[{"fDL", "[", 
          RowBox[{"L", ",", "base"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
            RowBox[{
             RowBox[{"Res", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "4"]}], 
               RowBox[{"gmn", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}]}], "]"}], " ", 
               RowBox[{"RicciScalarCD", "[", "]"}], " ", 
               RowBox[{"gamma", "[", 
                RowBox[{
                 RowBox[{"LI", "[", "6", "]"}], ",", 
                 RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"multiDot", "[", 
                RowBox[{
                 RowBox[{"RiemannCD", "[", 
                  RowBox[{
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "b"}], ",", 
                   RowBox[{"-", "c"}], ",", 
                   RowBox[{"-", "d"}]}], "]"}], ",", "gammaUU", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "}"}]}], "]"}]}]}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Res", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["1", "4"]}], 
              RowBox[{"RicciScalarCD", "[", "]"}], "  ", 
              RowBox[{"gamma", "[", 
               RowBox[{
                RowBox[{"LI", "[", "6", "]"}], ",", 
                RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}]}]}], 
           "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fComputeom", "[", 
    RowBox[{"L_", ",", "base_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "Lt", ",", "Res", ",", "spin", ",", "Trans"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "L", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lt", "=", 
       RowBox[{"ftrans", "[", 
        RowBox[{"L", ",", "base"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Res", "=", 
       RowBox[{"0", 
        RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"spin", "=", 
          RowBox[{"Spin", "[", 
           RowBox[{"L", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Trans", "=", 
          RowBox[{"{", 
           RowBox[{"spin", "+", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Trans", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"Trans", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"m", ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "spin"}], "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Res", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"t", "[", 
            RowBox[{
             RowBox[{"tp", "[", 
              RowBox[{"gammaU", ",", 
               RowBox[{"L", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
             "Trans"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Res", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], 
           RowBox[{"tp", "[", 
            RowBox[{
             RowBox[{"Lt", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "gammaU"}], 
            "]"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Return", "[", 
       RowBox[{"Res", "//", "SDI"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696496170665184*^9, 3.69649625138511*^9}, {
   3.696496303501919*^9, 3.6964964214768543`*^9}, {3.696496486346671*^9, 
   3.696496511779459*^9}, {3.6965022122296133`*^9, 3.696502214043751*^9}, {
   3.6965022535171947`*^9, 3.6965022538679447`*^9}, {3.696502303714635*^9, 
   3.6965023334689217`*^9}, {3.6965025003754263`*^9, 3.696502505855991*^9}, {
   3.696502666840115*^9, 3.696502668767721*^9}, {3.696502718223432*^9, 
   3.696502752147928*^9}, {3.69650288648248*^9, 3.696502886704111*^9}, {
   3.696502926678487*^9, 3.696502942559976*^9}, {3.696503024608488*^9, 
   3.6965030455644693`*^9}, {3.696503088206993*^9, 3.696503154299306*^9}, {
   3.696503188744644*^9, 3.6965032116413307`*^9}, {3.696503715309836*^9, 
   3.696503787073833*^9}, {3.696505649638336*^9, 3.696505666945696*^9}, {
   3.696506005779736*^9, 3.696506395857709*^9}, {3.696506513174161*^9, 
   3.696506872970207*^9}, {3.696506906475102*^9, 3.6965069091384087`*^9}, {
   3.696506952762953*^9, 3.696506997638891*^9}, {3.696507028830261*^9, 
   3.696507033062084*^9}, {3.6965070738538303`*^9, 3.696507082476576*^9}, {
   3.6965071320608187`*^9, 3.6965071751372967`*^9}, {3.696507258070879*^9, 
   3.696507330662694*^9}, {3.696507394129949*^9, 3.696507566015256*^9}, {
   3.6965075961627283`*^9, 3.6965075970149117`*^9}, {3.696507691913898*^9, 
   3.696507713451466*^9}, {3.696507745381392*^9, 3.696507789593055*^9}, {
   3.6965078699857397`*^9, 3.6965078778209543`*^9}, {3.6965079420176086`*^9, 
   3.696507966550495*^9}, {3.6965080059630947`*^9, 3.6965080364832373`*^9}, {
   3.696508085996008*^9, 3.696508152191852*^9}, {3.696508262365306*^9, 
   3.6965082938911963`*^9}, {3.696508475064823*^9, 3.696508496437914*^9}, {
   3.696508556255836*^9, 3.696508602280231*^9}, {3.6965086426516123`*^9, 
   3.696508777565333*^9}, {3.6965088255683937`*^9, 3.6965088958888702`*^9}, {
   3.6965090154018507`*^9, 3.696509177202279*^9}, {3.6965092176197653`*^9, 
   3.696509248336116*^9}, {3.696509624815854*^9, 3.696509656083509*^9}, {
   3.696509691958107*^9, 3.696509703922022*^9}, {3.696512620446163*^9, 
   3.696512641850823*^9}, 3.696512833889461*^9, {3.69651544180544*^9, 
   3.696515443219799*^9}, {3.69651552955796*^9, 3.696515551666492*^9}, {
   3.696515608323064*^9, 3.6965156146402884`*^9}, {3.6965193457637157`*^9, 
   3.696519352712426*^9}, {3.6965194277154713`*^9, 3.696519428445141*^9}, {
   3.696519508853821*^9, 3.696519511728986*^9}, {3.696519542329352*^9, 
   3.696519566889958*^9}, {3.696520501770549*^9, 3.696520503126637*^9}, {
   3.696520534011362*^9, 3.696520581093923*^9}, {3.696520864643024*^9, 
   3.69652088074934*^9}, {3.696520942357465*^9, 3.696520964313896*^9}, {
   3.696521025598537*^9, 3.696521025788281*^9}, {3.6965210617988987`*^9, 
   3.6965210623667297`*^9}, {3.69652109765235*^9, 3.6965210980310698`*^9}, {
   3.696522036685772*^9, 3.696522087155497*^9}, {3.6965223639207067`*^9, 
   3.6965223729233847`*^9}, {3.696522446387788*^9, 3.696522452687105*^9}, {
   3.69652263607447*^9, 3.696522642100966*^9}, {3.696522680135727*^9, 
   3.696522755550994*^9}, {3.696522902442686*^9, 3.69652299744044*^9}, {
   3.6965230628447323`*^9, 3.696523074240521*^9}, {3.696523144795459*^9, 
   3.696523171611848*^9}, {3.69652334275633*^9, 3.696523406137187*^9}, {
   3.696523473858386*^9, 3.696523603213641*^9}, {3.696523689466775*^9, 
   3.696523692231503*^9}, {3.6965237295375443`*^9, 3.696523755674961*^9}, {
   3.696523830554686*^9, 3.696523954120143*^9}, {3.696523996667708*^9, 
   3.696524031171885*^9}, {3.696524089431569*^9, 3.696524092667268*^9}, {
   3.6965241388546*^9, 3.69652415160318*^9}, {3.6965241851926413`*^9, 
   3.69652429171926*^9}, {3.696524326639439*^9, 3.6965243308842897`*^9}, {
   3.6965243744171124`*^9, 3.6965243819241867`*^9}, {3.696524415699312*^9, 
   3.69652444030597*^9}, {3.6965245858636827`*^9, 3.6965245878547087`*^9}, {
   3.6965246584514*^9, 3.6965246828435307`*^9}, {3.696524737528687*^9, 
   3.696524801380515*^9}, {3.696524980143413*^9, 3.696525018268044*^9}, {
   3.696525048273547*^9, 3.696525053523202*^9}, 3.696525119791066*^9, {
   3.696525157822349*^9, 3.696525158070834*^9}, {3.696525627287211*^9, 
   3.69652563723672*^9}, {3.696525912774983*^9, 3.696525915827092*^9}, {
   3.6965259477567587`*^9, 3.696525977159811*^9}, {3.696526228248872*^9, 
   3.696526291354684*^9}, {3.696526336173489*^9, 3.696526342285562*^9}, {
   3.696526393454715*^9, 3.696526473280506*^9}, {3.696526771461652*^9, 
   3.696526862621311*^9}, {3.696526903814761*^9, 3.6965270652735033`*^9}, {
   3.696527151503134*^9, 3.69652715768828*^9}, {3.6965272586703663`*^9, 
   3.6965273188369217`*^9}, {3.6965273925741367`*^9, 3.696527422928763*^9}, {
   3.696529417070772*^9, 3.6965294715316973`*^9}, {3.696531213383325*^9, 
   3.696531326760009*^9}, {3.6965334775368032`*^9, 3.696533484408121*^9}, {
   3.6965335154454937`*^9, 3.696533564902849*^9}, {3.69653361191894*^9, 
   3.6965336880099792`*^9}, {3.696533753609807*^9, 3.696533843037239*^9}, {
   3.6965338811769657`*^9, 3.6965338813337517`*^9}, {3.6965358015492*^9, 
   3.696535803559312*^9}, {3.696536055486618*^9, 3.6965360557349873`*^9}, {
   3.6965361489013777`*^9, 3.696536149325307*^9}, {3.6965669044092827`*^9, 
   3.696566908851604*^9}, {3.696586199808449*^9, 3.696586201439829*^9}, {
   3.696589351710883*^9, 3.696589355920204*^9}, {3.696618302904561*^9, 
   3.6966183057294283`*^9}, {3.696618455190777*^9, 3.6966184553249397`*^9}, {
   3.696657281355403*^9, 3.69665728232122*^9}, 3.696702888615759*^9, 
   3.6967029537417793`*^9, 3.696704173613913*^9, {3.696704618583663*^9, 
   3.696704654051901*^9}, {3.696704818169463*^9, 3.696704951160715*^9}, {
   3.696705709558873*^9, 3.696705726766623*^9}, {3.696740965819475*^9, 
   3.696740975610668*^9}, 3.69674102576724*^9, {3.6967413013083763`*^9, 
   3.696741304249524*^9}, {3.696741474404841*^9, 3.696741521473256*^9}, {
   3.6967422108638763`*^9, 3.696742211709938*^9}, {3.696757841093639*^9, 
   3.696757857796726*^9}, {3.696757903828972*^9, 3.696757926531391*^9}, {
   3.696757958474217*^9, 3.696757998863546*^9}, {3.696758355131452*^9, 
   3.696758406858514*^9}, {3.696758537571224*^9, 3.696758578190431*^9}, {
   3.69675871432972*^9, 3.696758743516473*^9}, {3.696758809291626*^9, 
   3.6967588095456533`*^9}, {3.696758945398809*^9, 3.696758975692255*^9}, 
   3.696759387928112*^9, {3.696763082864641*^9, 3.696763087104596*^9}, {
   3.696763562887344*^9, 3.6967635810425386`*^9}, 3.6967639616733303`*^9, 
   3.696764312043675*^9, 3.696764385311144*^9, {3.6967650440365353`*^9, 
   3.696765048347125*^9}, 3.6967650891368732`*^9, 3.696765129353704*^9, 
   3.696765194208256*^9, 3.696765327123263*^9, 3.696765601901586*^9, 
   3.696765893138329*^9, 3.696767850767185*^9, {3.696768070567408*^9, 
   3.696768086966737*^9}, {3.696768229027807*^9, 3.696768244913715*^9}, {
   3.6968369207014093`*^9, 3.6968369487670717`*^9}, {3.696873318862474*^9, 
   3.696873350314855*^9}, 3.6968733812061567`*^9, 3.696873675951511*^9, {
   3.696873716307898*^9, 3.6968737196824427`*^9}, {3.696873807673457*^9, 
   3.696873812418144*^9}, {3.696875154996387*^9, 3.6968751591628227`*^9}, {
   3.696877327079974*^9, 3.696877347501604*^9}, {3.696877382277165*^9, 
   3.69687740013157*^9}, {3.696877907138492*^9, 3.6968779127407207`*^9}, {
   3.696878528638502*^9, 3.696878529113937*^9}, 3.6968786728306417`*^9, 
   3.6969098698612013`*^9, {3.696909910446266*^9, 3.6969099671984577`*^9}, {
   3.696910049918509*^9, 3.6969100664685087`*^9}, {3.6969150512775087`*^9, 
   3.696915061241857*^9}, {3.696917598375711*^9, 3.696917626074768*^9}, {
   3.696917693073368*^9, 3.696917817829014*^9}, 3.6969179417122602`*^9, 
   3.696917974583651*^9, {3.6969180750495987`*^9, 3.696918098941826*^9}, {
   3.69691825365757*^9, 3.696918254433552*^9}, 3.696919093725298*^9, {
   3.6969194052921133`*^9, 3.696919446158229*^9}, {3.6969195363479633`*^9, 
   3.69691954409194*^9}, {3.6969200685079737`*^9, 3.696920106853032*^9}, {
   3.6969202038991327`*^9, 3.696920231034194*^9}, {3.696920333974681*^9, 
   3.696920334206966*^9}, {3.696930965305821*^9, 3.696930986641083*^9}, {
   3.6969310210646276`*^9, 3.6969310351208267`*^9}, {3.6969311333852158`*^9, 
   3.696931135499236*^9}, {3.696931331386327*^9, 3.696931332789116*^9}, {
   3.6969313886248837`*^9, 3.696931412567308*^9}, {3.696931444443869*^9, 
   3.696931586685988*^9}, {3.69693264394516*^9, 3.696932668032462*^9}, {
   3.696932755712586*^9, 3.6969328467225323`*^9}, {3.6969329823361387`*^9, 
   3.696933004574271*^9}, 3.696933085718533*^9, {3.6969332129879427`*^9, 
   3.6969332150971413`*^9}, {3.697032819044157*^9, 3.697032827016348*^9}, 
   3.697787229320599*^9, 3.697787269721239*^9, {3.697792267505022*^9, 
   3.6977922685348663`*^9}, {3.697792320270784*^9, 3.697792343590932*^9}, {
   3.697792386948269*^9, 3.6977924153624163`*^9}, 3.697792454498901*^9, {
   3.6977924864118357`*^9, 3.697792515823661*^9}, {3.69779256385769*^9, 
   3.697792566878627*^9}, {3.6977926302638407`*^9, 3.6977926588758783`*^9}, {
   3.6977928954550123`*^9, 3.697792896796467*^9}, {3.6977929545810966`*^9, 
   3.697792956211446*^9}, {3.69788151410203*^9, 3.697881523531588*^9}, {
   3.697881599983273*^9, 3.697881618200385*^9}, {3.697881743605308*^9, 
   3.697881745162003*^9}, 3.697881781364678*^9, {3.697991445970921*^9, 
   3.697991480724195*^9}, 3.698039201446917*^9, {3.6990718352471724`*^9, 
   3.699071859675214*^9}, {3.699072052404368*^9, 3.699072159608551*^9}, {
   3.6990722047931957`*^9, 3.6990722048695393`*^9}, {3.699072312569228*^9, 
   3.699072356143621*^9}, 3.699072405084791*^9, {3.6990724991179028`*^9, 
   3.699072645522098*^9}, {3.69907269133601*^9, 3.6990727390123053`*^9}, {
   3.699073135419327*^9, 3.6990731510644293`*^9}, {3.6990737153137627`*^9, 
   3.6990737865125103`*^9}, {3.699965607516391*^9, 3.699965625618503*^9}, {
   3.716110276367469*^9, 3.716110398911387*^9}, {3.718091115032651*^9, 
   3.718091208513749*^9}, {3.718091241509451*^9, 3.718091289468713*^9}, {
   3.718095071489607*^9, 3.718095137799979*^9}, {3.7180960140128183`*^9, 
   3.7180960289072313`*^9}, {3.718130194794249*^9, 3.718130228570466*^9}, {
   3.718130296991927*^9, 3.718130355714202*^9}, {3.7201878382192383`*^9, 
   3.720187894157344*^9}, {3.720187925977291*^9, 3.720187928645666*^9}, {
   3.72018796086924*^9, 3.7201879621475763`*^9}, {3.720188007042736*^9, 
   3.720188012425961*^9}, {3.725282537687701*^9, 3.725282539033053*^9}, {
   3.732188441483055*^9, 3.732188512104084*^9}, {3.830785622958761*^9, 
   3.830785644948118*^9}, 3.830785714377961*^9, {3.8488832951650352`*^9, 
   3.848883295738475*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"3354c88f-0982-4bec-be4f-86e200260422"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fProdom", "[", 
     RowBox[{"om_", ",", "base_", ",", "cont_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "omas", ",", "proj", ",", "Res", ",", "first", ",", "sec", 
        ",", "Trans", ",", "product", ",", "rank"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "om", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"omas", "=", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"om", "-", 
            RowBox[{"ftrans", "[", 
             RowBox[{"om", ",", "base"}], "]"}]}], ")"}]}], "//", "Simp"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"first", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"omas", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sec", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"omas", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"first", ">", " ", "0"}], " ", "&&", " ", 
             RowBox[{"sec", ">", " ", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Trans", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"m", ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", " ", 
                  RowBox[{"first", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Trans", ",", 
               RowBox[{"first", "+", "sec", "-", "1"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Trans", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Trans", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"first", "+", "m", "-", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"sec", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"Trans", ",", 
               RowBox[{"first", "+", "sec"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"proj", "=", 
              RowBox[{"omas", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"product", "=", 
              RowBox[{"t", "[", 
               RowBox[{
                RowBox[{"tp", "[", 
                 RowBox[{
                  RowBox[{"omas", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", "proj"}], 
                 "]"}], ",", "Trans"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"base", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"product", "=", 
                 RowBox[{"Contract", "[", 
                  RowBox[{"product", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"first", "-", "1"}], ",", "first"}], "}"}], 
                    "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"cont", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"rank", "=", 
                 RowBox[{"Spin", "[", "product", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"product", "=", 
                 RowBox[{"Contract", "[", 
                  RowBox[{"product", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rank", "-", "1"}], ",", "rank"}], "}"}], "}"}]}],
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Res", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "+=", "product"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fDom", "[", 
     RowBox[{"om_", ",", "base_", ",", "cont_", ",", "sym_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "Res", ",", "oms", ",", "spin", ",", "Trans"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "om", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", 
        RowBox[{"0", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sym", "\[Equal]", "\"\<Anti\>\""}], ",", 
         RowBox[{"oms", "=", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"om", "-", 
              RowBox[{"ftrans", "[", 
               RowBox[{"om", ",", "base"}], "]"}]}], ")"}]}], "//", 
           "Simp"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sym", "\[Equal]", "\"\<E\>\""}], ",", 
         RowBox[{"oms", "=", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"om", "+", 
              RowBox[{"ftrans", "[", 
               RowBox[{"om", ",", "base"}], "]"}]}], ")"}]}], "//", 
           "Simp"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spin", "=", 
           RowBox[{"Spin", "[", 
            RowBox[{"oms", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"spin", ">", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"cont", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Res", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"Contract", "[", 
                RowBox[{
                 RowBox[{"covD", "[", 
                  RowBox[{"oms", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin", ",", 
                    RowBox[{"spin", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Trans", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{"m", ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"spin", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"Trans", ",", 
                 RowBox[{"spin", "+", "1"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"Trans", ",", "spin"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Res", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                RowBox[{"t", "[", 
                 RowBox[{
                  RowBox[{"covD", "[", 
                   RowBox[{"oms", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
                  "Trans"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
            "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fComputeE", "[", 
     RowBox[{"P_", ",", "base_", ",", "om_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Omsq", ",", "Domp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Omsq", "=", 
        RowBox[{"fProdom", "[", 
         RowBox[{"om", ",", "base", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Domp", "=", 
        RowBox[{"fDom", "[", 
         RowBox[{"om", ",", "base", ",", "True", ",", "\"\<E\>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"P", "+", 
             RowBox[{"ftrans", "[", 
              RowBox[{"P", ",", "base"}], "]"}]}], ")"}]}], "-", "Omsq", "-", 
          " ", "Domp"}], "//", "SDI"}], "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fComputeOm", "[", 
    RowBox[{"om_", ",", "base_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Res", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "base", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Res", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"fProdom", "[", 
          RowBox[{"om", ",", "base", ",", "False"}], "]"}], "+", 
         RowBox[{"fDom", "[", 
          RowBox[{"om", ",", "base", ",", "False", ",", "\"\<Anti\>\""}], 
          "]"}]}], "//", "gSimp"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Res", "=", 
       RowBox[{"Res", "-", 
        RowBox[{"ftab", "[", "Res", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"base", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Res", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              FractionBox["1", "4"], 
              RowBox[{"tp", "[", 
               RowBox[{
                RowBox[{"gmn", "[", 
                 RowBox[{
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{"-", "b"}]}], "]"}], ",", 
                RowBox[{"multiDot", "[", 
                 RowBox[{
                  RowBox[{"RiemannCD", "[", 
                   RowBox[{
                    RowBox[{"-", "a"}], ",", 
                    RowBox[{"-", "b"}], ",", 
                    RowBox[{"-", "c"}], ",", 
                    RowBox[{"-", "d"}]}], "]"}], ",", "gammaUU", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], 
               "]"}]}], "+", "  ", 
             RowBox[{"tp", "[", 
              RowBox[{
               RowBox[{"RiemannCD", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}], ",", 
                 RowBox[{"-", "c"}], ",", 
                 RowBox[{"-", "d"}]}], "]"}], ",", 
               RowBox[{"delta", "[", 
                RowBox[{
                 RowBox[{"-", "\[Alpha]"}], ",", "\[Beta]"}], "]"}]}], 
              "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"base", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Res", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
            RowBox[{
             FractionBox["1", "4"], 
             RowBox[{"multiDot", "[", 
              RowBox[{
               RowBox[{"RiemannCD", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "b"}], ",", 
                 RowBox[{"-", "c"}], ",", 
                 RowBox[{"-", "d"}]}], "]"}], ",", "gammaUU", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"3", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"4", ",", "2"}], "}"}]}], "}"}]}], "]"}]}]}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Res", "//", "gSimp"}], "//", "fSimp"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696519669982012*^9, 3.696519810820767*^9}, {
   3.696519886983322*^9, 3.696519887899124*^9}, {3.696519962961192*^9, 
   3.6965200226985903`*^9}, {3.6965219683764753`*^9, 3.69652197701086*^9}, {
   3.696522028406497*^9, 3.696522028547551*^9}, {3.6965221076849623`*^9, 
   3.6965221233938513`*^9}, 3.6965359706822233`*^9, {3.696536272921205*^9, 
   3.696536293306204*^9}, {3.696536327523238*^9, 3.696536332894059*^9}, {
   3.696536427883543*^9, 3.696536488885421*^9}, 3.696536521987926*^9, {
   3.6965365958788843`*^9, 3.6965365975863657`*^9}, {3.696536707547503*^9, 
   3.696536707860742*^9}, {3.696536768413759*^9, 3.696536776221332*^9}, {
   3.696536817416545*^9, 3.696536817579774*^9}, {3.696537006968272*^9, 
   3.696537010934123*^9}, {3.696537094629678*^9, 3.696537098836082*^9}, {
   3.696659539594626*^9, 3.696659542290185*^9}, 3.696677336774501*^9, {
   3.696704965374951*^9, 3.6967050013391113`*^9}, {3.696705058649631*^9, 
   3.696705079014844*^9}, {3.69670551044541*^9, 3.696705514043079*^9}, {
   3.696705672344302*^9, 3.696705682663322*^9}, 3.696705867828176*^9, {
   3.696706814441931*^9, 3.696706822416543*^9}, {3.696742235789225*^9, 
   3.696742240006864*^9}, {3.6967422712847967`*^9, 3.6967423131314383`*^9}, {
   3.696742678639124*^9, 3.696742680055543*^9}, {3.696909773556774*^9, 
   3.6969097776579847`*^9}, {3.696914781907069*^9, 3.696914782719633*^9}, {
   3.6969182722593737`*^9, 3.696918298085693*^9}, {3.696930663864447*^9, 
   3.696930700830772*^9}, {3.6969308673366117`*^9, 3.6969309054399157`*^9}, {
   3.696930978336804*^9, 3.696930978638771*^9}, {3.696931790471574*^9, 
   3.6969318168795223`*^9}, {3.696931907090323*^9, 3.696931919004755*^9}, 
   3.696931957649867*^9, {3.696932190975727*^9, 3.6969321927269573`*^9}, {
   3.696932257489307*^9, 3.696932259203381*^9}, {3.696932499356833*^9, 
   3.696932531306765*^9}, {3.697032846453888*^9, 3.697032868430646*^9}, {
   3.697032933854919*^9, 3.697032937375918*^9}, {3.697093368455132*^9, 
   3.6970933690850897`*^9}, 3.697093837279715*^9, {3.697096141115831*^9, 
   3.6970961414172297`*^9}, {3.697096182576707*^9, 3.697096182638418*^9}, 
   3.697096269934874*^9, {3.697439761812414*^9, 3.697439787098085*^9}, {
   3.697641725922164*^9, 3.69764176308703*^9}, {3.697645341667309*^9, 
   3.6976453640246077`*^9}, {3.6977920178049583`*^9, 
   3.6977920248365307`*^9}, {3.69779208739071*^9, 3.697792108848702*^9}, {
   3.697792154212718*^9, 3.69779215609166*^9}, {3.697792209164051*^9, 
   3.697792209313321*^9}, {3.697801292564878*^9, 3.69780129339497*^9}, {
   3.697880785669389*^9, 3.697880789586288*^9}, {3.6978840226501713`*^9, 
   3.6978840577188597`*^9}, {3.697884158894597*^9, 3.697884206849065*^9}, {
   3.697884295290434*^9, 3.697884298071023*^9}, {3.697884916352727*^9, 
   3.697884916574361*^9}, {3.697887445678259*^9, 3.697887448829064*^9}, {
   3.6978874887514477`*^9, 3.697887489308016*^9}, {3.69788767912652*^9, 
   3.697887686052845*^9}, {3.697887741973403*^9, 3.6978877436125603`*^9}, {
   3.697887780158937*^9, 3.6978877853054333`*^9}, {3.69907383519215*^9, 
   3.699073866907645*^9}, {3.699073933570693*^9, 3.699073933959433*^9}, {
   3.70330860089154*^9, 3.7033087873736563`*^9}, {3.7033088553262053`*^9, 
   3.7033088642232113`*^9}, {3.732122376369843*^9, 3.732122398880097*^9}, {
   3.732123578593807*^9, 3.732123601279114*^9}, {3.732125502725896*^9, 
   3.732125507019615*^9}, 3.732126723701737*^9, {3.732127335574266*^9, 
   3.7321273428602247`*^9}, {3.732127708561152*^9, 3.7321277089893827`*^9}, {
   3.732127877728828*^9, 3.732127878974798*^9}, 3.732127925994585*^9, {
   3.732127959194685*^9, 3.7321279983585787`*^9}, {3.732128137902671*^9, 
   3.732128138732705*^9}, {3.732132778747604*^9, 3.7321327939136467`*^9}, {
   3.7321328682521152`*^9, 3.732132870405026*^9}, {3.7321329046517057`*^9, 
   3.732132905966091*^9}, {3.732170043876709*^9, 3.732170044170553*^9}, {
   3.732188529287868*^9, 3.7321885296977*^9}, {3.734183419568746*^9, 
   3.734183447697349*^9}, {3.734183559759788*^9, 3.734183577045034*^9}, {
   3.7341840216643057`*^9, 3.734184034226729*^9}, {3.7341924472827597`*^9, 
   3.7341924646133633`*^9}, {3.8307847098882027`*^9, 
   3.8307847493539333`*^9}, {3.830784880327456*^9, 3.830784919666452*^9}, {
   3.830785026983811*^9, 3.8307850281860847`*^9}, {3.830785358447278*^9, 
   3.830785447533456*^9}, {3.830785516441887*^9, 3.83078551710464*^9}, {
   3.830785565471951*^9, 3.830785565568646*^9}, {3.830811073231701*^9, 
   3.830811075339571*^9}, {3.830815664877795*^9, 3.8308156649991426`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"a99d2837-f697-4313-8795-da159ca88a2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTr", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"in", " ", 
          RowBox[{"delta", "[", 
           RowBox[{
            RowBox[{"-", "\[Beta]"}], ",", "\[Alpha]"}], "]"}]}], "//", 
         "Simp"}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTrg", "[", "in_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Lower", "[", "in", "]"}], 
        RowBox[{"gmn", "[", 
         RowBox[{"a", ",", "b"}], "]"}], 
        RowBox[{"delta", "[", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", "\[Alpha]"}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fSqgg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"in", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Lower", "[", "in", "]"}], 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Raise", "[", 
            RowBox[{"ReplaceDummies", "[", 
             RowBox[{"Evaluate", "[", "bin", "]"}], "]"}], "]"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "b"}], ",", 
            RowBox[{"b", "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"-", "\[Alpha]"}], "\[Rule]", 
             RowBox[{"-", "\[Beta]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", "\[Alpha]"}]}], "}"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fSqg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"in", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Lower", "[", "in", "]"}], 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Raise", "[", 
            RowBox[{"ReplaceDummies", "[", 
             RowBox[{"Evaluate", "[", "bin", "]"}], "]"}], "]"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Alpha]"}], "\[Rule]", 
             RowBox[{"-", "\[Beta]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", "\[Alpha]"}]}], "}"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fSq", "[", 
     RowBox[{"in_", ",", "bin_", ",", "rspin_", ",", "lspin_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"in", " ", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{"ReplaceDummies", "[", 
               RowBox[{"Evaluate", "[", "bin", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[Alpha]"}], "\[Rule]", 
                RowBox[{"-", "\[Beta]"}]}], ",", 
               RowBox[{"\[Beta]", "\[Rule]", "\[Alpha]"}]}], "}"}]}], "]"}]}],
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fSqg", "[", 
           RowBox[{"in", ",", "bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fSqg", "[", 
           RowBox[{"in", ",", "bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fSqgg", "[", 
           RowBox[{"in", ",", "bin"}], "]"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTrE", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Res", "+=", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"base", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", 
            RowBox[{"fTr", "[", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "]"}], ",", "1", ",", 
            RowBox[{"fTrg", "[", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTrSq", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Res", "+=", 
          RowBox[{"fSq", "[", 
           RowBox[{
            RowBox[{"in", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"in", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"base", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"base", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frTrSq", "[", 
     RowBox[{"in_", ",", "base_", ",", "list_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fTrSq", "[", 
           RowBox[{"in", ",", "base"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Res", "+=", " ", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"fSq", "[", 
            RowBox[{
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
             
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "3"}], "]"}], "]"}], ",", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
             
             RowBox[{"base", "[", 
              RowBox[{"[", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
            "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fSqOgg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"in", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Lower", "[", "in", "]"}], 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Raise", "[", 
            RowBox[{"ReplaceDummies", "[", 
             RowBox[{"Evaluate", "[", "bin", "]"}], "]"}], "]"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "\[Rule]", "b"}], ",", 
            RowBox[{"b", "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"-", "\[Alpha]"}], "\[Rule]", 
             RowBox[{"-", "\[Beta]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", "\[Alpha]"}]}], "}"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fSqOg", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"in", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Lower", "[", "in", "]"}], 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Raise", "[", 
            RowBox[{"ReplaceDummies", "[", 
             RowBox[{"Evaluate", "[", "bin", "]"}], "]"}], "]"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Alpha]"}], "\[Rule]", 
             RowBox[{"-", "\[Beta]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", "\[Alpha]"}]}], "}"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fSqO", "[", 
    RowBox[{"in_", ",", "bin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"in", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"in", " ", 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Raise", "[", 
            RowBox[{"ReplaceDummies", "[", 
             RowBox[{"Evaluate", "[", "bin", "]"}], "]"}], "]"}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Alpha]"}], "\[Rule]", 
             RowBox[{"-", "\[Beta]"}]}], ",", 
            RowBox[{"\[Beta]", "\[Rule]", "\[Alpha]"}]}], "}"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fSqOm", "[", 
     RowBox[{"in_", ",", "bin_", ",", "rspin_", ",", "lspin_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fSqO", "[", 
           RowBox[{"in", ",", "bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], " ", "||", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fSqOg", "[", 
           RowBox[{"in", ",", "bin"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lspin", ",", "rspin"}], "}"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"fSqOgg", "[", 
           RowBox[{"in", ",", "bin"}], "]"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fTrSqO", "[", 
     RowBox[{"in_", ",", "base_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Res", ",", "val", ",", "n", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "in", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"val", "=", 
           RowBox[{"fSqOm", "[", 
            RowBox[{
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"in", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"base", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Res", "+=", "val"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frTrSqO", "[", 
    RowBox[{"in_", ",", "base_", ",", "list_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Res", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"fTrSqO", "[", 
          RowBox[{"in", ",", "base"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Res", "+=", " ", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "1"}], "]"}], "]"}], "  ", 
          RowBox[{"fSqOm", "[", 
           RowBox[{
            RowBox[{"in", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "3"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"in", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "3"}], "]"}], "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"base", "[", 
             RowBox[{"[", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"base", "[", 
             RowBox[{"[", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Res", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6966228849737988`*^9, 3.696623248698042*^9}, {
   3.6966233731220713`*^9, 3.696623387182119*^9}, {3.696623461135674*^9, 
   3.6966234614524593`*^9}, {3.696623510924965*^9, 3.696623520724478*^9}, {
   3.6966236029558277`*^9, 3.6966236531193867`*^9}, {3.69662370473695*^9, 
   3.696623778095096*^9}, {3.696624017497582*^9, 3.696624069179489*^9}, {
   3.696624691900918*^9, 3.69662473646736*^9}, {3.696624805236237*^9, 
   3.6966248314305077`*^9}, 3.696624887321185*^9, 3.696655401054159*^9, {
   3.696656451902877*^9, 3.696656467422184*^9}, {3.696656498082026*^9, 
   3.69665654156236*^9}, {3.6966572869860477`*^9, 3.696657297310985*^9}, {
   3.6966584222409763`*^9, 3.696658488331998*^9}, {3.696705089801197*^9, 
   3.6967051267994547`*^9}, 3.6968369608795033`*^9, {3.696847278520933*^9, 
   3.696847279171649*^9}, {3.696933315080221*^9, 3.69693331537402*^9}, {
   3.6969333612049103`*^9, 3.6969333667313547`*^9}, {3.696933402569886*^9, 
   3.696933419475144*^9}, {3.696933472636631*^9, 3.696933563447205*^9}, {
   3.6969335958216467`*^9, 3.696933659859561*^9}, {3.697093911881342*^9, 
   3.697093914702244*^9}, 3.697801124118256*^9, {3.697801155363557*^9, 
   3.697801225441029*^9}, {3.697885282641369*^9, 3.697885287305744*^9}, {
   3.697885325075025*^9, 3.6978854192783337`*^9}, {3.697885491501191*^9, 
   3.6978855742013617`*^9}, {3.697885609747649*^9, 3.697885613887388*^9}, {
   3.6990740656745872`*^9, 3.699074066671343*^9}, {3.699075346950775*^9, 
   3.6990753919928303`*^9}, {3.7033083404203587`*^9, 
   3.7033083905240993`*^9}, {3.732188543078751*^9, 3.732188557916677*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"3ecb3ceb-79fd-44d7-b1e7-b5fa59a18fbe"]
}, Closed]]
}, Open  ]]
},
WindowSize->{1228, 836},
WindowMargins->{{86, Automatic}, {-39, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification->1.5,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5cff28fb-5040-4bd8-a475-bd84ce1fd030"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 155, 3, 101, "Section",ExpressionUUID->"6affce9e-8bf5-478a-b701-d77b55bdf71a"],
Cell[738, 27, 270, 6, 53, "Text",ExpressionUUID->"c3726963-2056-4a6f-9063-f1eb650d98cd"],
Cell[CellGroupData[{
Cell[1033, 37, 210, 4, 81, "Subsection",ExpressionUUID->"5e3bacde-92c7-4ad3-b164-ab333af22125"],
Cell[1246, 43, 29019, 612, 2744, "Input",ExpressionUUID->"c83d65ac-081c-4d9f-ab73-0c627fc3440e"]
}, Closed]],
Cell[CellGroupData[{
Cell[30302, 660, 221, 4, 55, "Subsection",ExpressionUUID->"e283b3d3-625f-4bc3-8e24-e9b83d2e6b40"],
Cell[30526, 666, 12434, 308, 1721, "Input",ExpressionUUID->"1e2d426b-519f-42d7-bed3-0202f3b8edf4"]
}, Closed]],
Cell[CellGroupData[{
Cell[42997, 979, 167, 3, 55, "Subsection",ExpressionUUID->"5ee06429-47f7-4592-abab-a4d3cb6ea58b"],
Cell[43167, 984, 19787, 461, 2630, "Input",ExpressionUUID->"ff26c383-4821-4178-8d5b-e6ee8531debd"],
Cell[CellGroupData[{
Cell[62979, 1449, 215, 4, 67, "Subsubsection",ExpressionUUID->"b5ffae47-519f-40db-bd8c-5a3e3dd10c9f"],
Cell[63197, 1455, 9061, 262, 828, "Input",ExpressionUUID->"542242ff-41f3-4be2-8810-62737cc19a43"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[72307, 1723, 170, 3, 55, "Subsection",ExpressionUUID->"216a38c3-f3ef-42e4-9a0e-08429d2fd82b"],
Cell[72480, 1728, 117639, 2757, 11740, "Input",ExpressionUUID->"21f4052e-2035-483c-b23a-2bcdd2d3ae03"]
}, Closed]],
Cell[CellGroupData[{
Cell[190156, 4490, 167, 3, 55, "Subsection",ExpressionUUID->"7dafe2a0-39fa-42f5-9be9-a5ec2a194d97"],
Cell[190326, 4495, 59111, 1467, 6540, "Input",ExpressionUUID->"38e2594a-7a7c-44d1-8655-fc5744a6fd53"]
}, Closed]],
Cell[CellGroupData[{
Cell[249474, 5967, 164, 3, 55, "Subsection",ExpressionUUID->"e4b4fd70-8892-4465-a7da-d181adbb32e7"],
Cell[249641, 5972, 45659, 1183, 4263, "Input",ExpressionUUID->"325d4bed-8314-463d-bd41-15d84d4a760b"]
}, Closed]],
Cell[CellGroupData[{
Cell[295337, 7160, 169, 3, 55, "Subsection",ExpressionUUID->"6d393f68-f774-48d5-8921-99c14dbc20c0"],
Cell[295509, 7165, 29349, 642, 3237, "Input",ExpressionUUID->"3354c88f-0982-4bec-be4f-86e200260422"],
Cell[324861, 7809, 19050, 433, 2263, "Input",ExpressionUUID->"a99d2837-f697-4313-8795-da159ca88a2b"],
Cell[343914, 8244, 20908, 555, 2682, "Input",ExpressionUUID->"3ecb3ceb-79fd-44d7-b1e7-b5fa59a18fbe"]
}, Closed]]
}, Open  ]]
}
]
*)

